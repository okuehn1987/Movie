import{d as v,T as z,M as p,a as M,o as m,c as f,w as a,V as C,G as D,b as o,U as B,k as F,l as A,m as x,n as u,s as i,B as d,u as s,j as T,p as V,v as N,x as L,F as E,e as I,g as c,h as G,W as J,D as y}from"./app-D7N-wvAF.js";const P=v({__name:"UserForm",props:{user:{},operating_sites:{},permissions:{},groups:{},mode:{}},emits:["success"],setup(w,{emit:S}){var _;const t=w,U=S,e=z({first_name:"",last_name:"",email:"",date_of_birth:null,city:"",zip:"",street:"",house_number:"",address_suffix:"",country:"",federal_state:"",phone_number:"",staff_number:0,password:"",group_id:null,operating_site_id:null,userWorkingHours:0,userWorkingHoursSince:new Date,userWorkingWeek:[],userWorkingWeekSince:new Date,permissions:[]});if(t.user){e.first_name=t.user.first_name,e.last_name=t.user.last_name,e.email=t.user.email,e.date_of_birth=t.user.date_of_birth,e.city=t.user.city??"",e.zip=t.user.zip??"",e.street=t.user.street??"",e.house_number=t.user.house_number??"",e.address_suffix=t.user.address_suffix??"",e.country=t.user.country??"",e.federal_state=t.user.federal_state??"",e.phone_number=t.user.phone_number??"",e.staff_number=t.user.staff_number,e.password=t.user.password,e.group_id=t.user.group_id,e.operating_site_id=t.user.operating_site_id,e.userWorkingHours=((_=t.user.lastWorkingHours)==null?void 0:_.weekly_working_hours)??0,e.userWorkingHoursSince=new Date(t.user.lastWorkingHours.active_since);for(const n of p.weekdays("long",{locale:"en"}).map(r=>r.toLowerCase()))t.user.userWorkingWeek[n]&&e.userWorkingWeek.push(n);e.userWorkingWeekSince=new Date(t.user.userWorkingWeek.active_since);for(const n of t.permissions)t.user[n.name]&&e.permissions.push(n.name)}function H(){const n=e.transform(r=>({...r,userWorkingHoursSince:y.fromJSDate(e.userWorkingHoursSince).toFormat("yyyy-MM-dd"),userWorkingWeekSince:y.fromJSDate(e.userWorkingWeekSince).toFormat("yyyy-MM-dd"),date_of_birth:r.date_of_birth?new Date(r.date_of_birth).toISOString():null}));t.mode=="edit"&&t.user?n.patch(route("user.update",{user:t.user.id}),{}):n.post(route("user.store"),{onSuccess:()=>{e.reset(),U("success")},onError:r=>console.log(r)})}return(n,r)=>{var k,W;const b=M("v-date-input");return m(),f(C,{title:n.mode==="create"?"Mitarbeiter hinzufügen":((k=t.user)==null?void 0:k.first_name)+" "+((W=t.user)==null?void 0:W.last_name)},{append:a(()=>[D(n.$slots,"append")]),default:a(()=>[o(B),o(G,null,{default:a(()=>[o(F,{onSubmit:A(H,["prevent"])},{default:a(()=>[o(x,null,{default:a(()=>[o(u,{cols:"12"},{default:a(()=>r[18]||(r[18]=[i("h3",null,"Allgemeine Informationen",-1)])),_:1}),o(u,{cols:"12",md:"6"},{default:a(()=>[o(d,{modelValue:s(e).first_name,"onUpdate:modelValue":r[0]||(r[0]=l=>s(e).first_name=l),label:"Vorname","error-messages":s(e).errors.first_name},null,8,["modelValue","error-messages"])]),_:1}),o(u,{cols:"12",md:"6"},{default:a(()=>[o(d,{modelValue:s(e).last_name,"onUpdate:modelValue":r[1]||(r[1]=l=>s(e).last_name=l),label:"Nachname","error-messages":s(e).errors.last_name},null,8,["modelValue","error-messages"])]),_:1}),o(u,{cols:"12",md:"6"},{default:a(()=>[o(d,{modelValue:s(e).email,"onUpdate:modelValue":r[2]||(r[2]=l=>s(e).email=l),label:"Email","error-messages":s(e).errors.email},null,8,["modelValue","error-messages"])]),_:1}),n.mode=="create"?(m(),f(u,{key:0,cols:"12",md:"6"},{default:a(()=>[o(d,{modelValue:s(e).password,"onUpdate:modelValue":r[3]||(r[3]=l=>s(e).password=l),label:"Passwort","error-messages":s(e).errors.password},null,8,["modelValue","error-messages"])]),_:1})):T("",!0),o(u,{cols:"12",md:"6"},{default:a(()=>[o(d,{type:"date",modelValue:s(e).date_of_birth,"onUpdate:modelValue":r[4]||(r[4]=l=>s(e).date_of_birth=l),label:"Geburtsdatum",required:"","error-messages":s(e).errors.date_of_birth},null,8,["modelValue","error-messages"])]),_:1}),o(u,{cols:"12"},{default:a(()=>r[19]||(r[19]=[i("h3",null,"Adresse",-1)])),_:1}),o(u,{cols:"12",md:"6"},{default:a(()=>[o(d,{modelValue:s(e).street,"onUpdate:modelValue":r[5]||(r[5]=l=>s(e).street=l),label:"Straße","error-messages":s(e).errors.street},null,8,["modelValue","error-messages"])]),_:1}),o(u,{cols:"12",md:"6"},{default:a(()=>[o(d,{modelValue:s(e).house_number,"onUpdate:modelValue":r[6]||(r[6]=l=>s(e).house_number=l),label:"Hausnummer","error-messages":s(e).errors.house_number},null,8,["modelValue","error-messages"])]),_:1}),o(u,{cols:"12",md:"6"},{default:a(()=>[o(d,{modelValue:s(e).zip,"onUpdate:modelValue":r[7]||(r[7]=l=>s(e).zip=l),label:"Postleitzahl","error-messages":s(e).errors.zip},null,8,["modelValue","error-messages"])]),_:1}),o(u,{cols:"12",md:"6"},{default:a(()=>[o(d,{modelValue:s(e).city,"onUpdate:modelValue":r[8]||(r[8]=l=>s(e).city=l),label:"Ort","error-messages":s(e).errors.city},null,8,["modelValue","error-messages"])]),_:1}),o(u,{cols:"12",md:"6"},{default:a(()=>[o(d,{modelValue:s(e).federal_state,"onUpdate:modelValue":r[9]||(r[9]=l=>s(e).federal_state=l),label:"Bundesland","error-messages":s(e).errors.federal_state},null,8,["modelValue","error-messages"])]),_:1}),o(u,{cols:"12",md:"6"},{default:a(()=>[o(d,{modelValue:s(e).country,"onUpdate:modelValue":r[10]||(r[10]=l=>s(e).country=l),label:"Land","error-messages":s(e).errors.country},null,8,["modelValue","error-messages"])]),_:1}),o(u,{cols:"12"},{default:a(()=>r[20]||(r[20]=[i("h3",null,"Abteilung",-1)])),_:1}),o(u,{cols:"12",md:"6"},{default:a(()=>[o(V,{modelValue:s(e).group_id,"onUpdate:modelValue":r[11]||(r[11]=l=>s(e).group_id=l),items:n.groups.map(l=>({title:l.name,value:l.id})),label:"Wähle eine Abteilung aus, zu die der Mitarbeiter gehören soll.","error-messages":s(e).errors.group_id},null,8,["modelValue","items","error-messages"])]),_:1}),o(u,{cols:"12",md:"6"},{default:a(()=>[o(V,{modelValue:s(e).operating_site_id,"onUpdate:modelValue":r[12]||(r[12]=l=>s(e).operating_site_id=l),items:n.operating_sites.map(l=>({title:l.name,value:l.id})),label:"Wähle die Betriebsstätte des Mitarbeiters aus.","error-messages":s(e).errors.operating_site_id},null,8,["modelValue","items","error-messages"])]),_:1}),o(u,{cols:"12"},{default:a(()=>r[21]||(r[21]=[i("h3",null,"Wöchentliche Arbeitszeit",-1)])),_:1}),o(u,{cols:"12",md:"6"},{default:a(()=>[o(d,{modelValue:s(e).userWorkingHours,"onUpdate:modelValue":r[13]||(r[13]=l=>s(e).userWorkingHours=l),label:"Trage die wöchentliche Arbeitszeit des Mitarbeiters ein","error-messages":s(e).errors.userWorkingHours},null,8,["modelValue","error-messages"])]),_:1}),o(u,{cols:"12",md:"6"},{default:a(()=>[o(b,{"prepend-icon":"",modelValue:s(e).userWorkingHoursSince,"onUpdate:modelValue":r[14]||(r[14]=l=>s(e).userWorkingHoursSince=l),label:"seit","error-messages":s(e).errors.userWorkingHoursSince},null,8,["modelValue","error-messages"])]),_:1}),o(u,{cols:"12",md:"6"},{default:a(()=>[o(V,{modelValue:s(e).userWorkingWeek,"onUpdate:modelValue":r[15]||(r[15]=l=>s(e).userWorkingWeek=l),multiple:"",items:s(p).weekdays().map((l,g)=>({title:l,value:s(p).weekdays("long",{locale:"en"})[g].toLowerCase()})),label:"Wähle die Arbeitstage des Mitarbeiters aus","error-messages":s(e).errors.userWorkingWeek},null,8,["modelValue","items","error-messages"])]),_:1}),o(u,{cols:"12",md:"6"},{default:a(()=>[o(b,{"prepend-icon":"",modelValue:s(e).userWorkingWeekSince,"onUpdate:modelValue":r[16]||(r[16]=l=>s(e).userWorkingWeekSince=l),label:"seit","error-messages":s(e).errors.userWorkingWeekSince},null,8,["modelValue","error-messages"])]),_:1}),o(u,{cols:"12"},{default:a(()=>r[22]||(r[22]=[i("h3",null,"Berechtigungen",-1)])),_:1}),(m(!0),N(E,null,L(n.permissions,l=>(m(),f(u,{cols:"12",md:"6",key:l.name},{default:a(()=>[o(J,{modelValue:s(e).permissions,"onUpdate:modelValue":r[17]||(r[17]=g=>s(e).permissions=g),value:l.name,label:l.label,"hide-details":""},null,8,["modelValue","value","label"])]),_:2},1024))),128)),o(u,{cols:"12",class:"text-end"},{default:a(()=>[o(I,{type:"submit",color:"primary",loading:s(e).processing},{default:a(()=>r[23]||(r[23]=[c("Speichern")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:3},8,["title"])}}});export{P as _};

import{d as _,R as x,w as T,a as k,o as q,Q as C,b as t,f as r,x as I,E as P,i as s,G as v,s as u,g as B,J as A,m as R,H as D,I as w,K as S,L as o,N as n,M as F,ab as M,a8 as $,a9 as j,p,t as z,O as d,a1 as g,a2 as E,l as V,V as K,P as N}from"./app-DpliNvEz.js";import{P as O}from"./types-BVvW7sCV.js";import{f as L}from"./utils-BtTTUqX5.js";const J=_({__name:"TicketCreateDialog",props:{customers:{},users:{},operatingSites:{}},setup(c){var f;const U=c,l=useForm({title:"",description:"",priority:"medium",customer_id:null,assignees:[x().props.auth.user.id],start:null,duration:"00:00",operatingSite:(f=U.operatingSites.find(i=>i.value.type==="App\\Models\\OperatingSite"))==null?void 0:f.value,resources:"",appointment_at:null,files:[],tab:"ticket"});function y(i){l.post(route("ticket.store"),{onSuccess:()=>{l.reset(),i.value=!1}})}return T(()=>l.customer_id,()=>{l.reset("operatingSite")}),(i,a)=>(q(),k(C,{"max-width":"600px"},{activator:t(({props:m})=>[r(V,N({title:"Auftrag erstellen"},m,{color:"primary"}),{default:t(()=>[r(p,{icon:"mdi-plus"})]),_:1},16)]),default:t(({isActive:m})=>[r(K,{title:"Auftrag hinzufügen"},{append:t(()=>[r(V,{icon:"",variant:"text",onClick:e=>m.value=!1},{default:t(()=>[r(p,null,{default:t(()=>[...a[16]||(a[16]=[u("mdi-close",-1)])]),_:1})]),_:1},8,["onClick"])]),default:t(()=>[r(I),r(P,{modelValue:s(l).tab,"onUpdate:modelValue":a[0]||(a[0]=e=>s(l).tab=e)},{default:t(()=>[r(v,{class:"w-50",value:"ticket"},{default:t(()=>[...a[17]||(a[17]=[u("Auftrag",-1)])]),_:1}),r(v,{class:"w-50",value:"expressTicket"},{default:t(()=>[...a[18]||(a[18]=[u("Einzelauftrag",-1)])]),_:1})]),_:1},8,["modelValue"]),r(B,{style:{"max-height":"750px","overflow-y":"auto"}},{default:t(()=>[r(A,{onSubmit:R(e=>y(m),["prevent"])},{default:t(()=>[r(D,{modelValue:s(l).tab,"onUpdate:modelValue":a[15]||(a[15]=e=>s(l).tab=e)},{default:t(()=>[r(w,{value:"ticket"},{default:t(()=>[r(S,null,{default:t(()=>[r(o,{cols:"12",md:"8"},{default:t(()=>[r(n,{label:"Kunde wählen",required:"",items:i.customers.map(e=>({value:e.id,title:e.name})),modelValue:s(l).customer_id,"onUpdate:modelValue":a[1]||(a[1]=e=>s(l).customer_id=e),"error-messages":s(l).errors.customer_id},null,8,["items","modelValue","error-messages"])]),_:1}),r(o,{cols:"12",md:"4"},{default:t(()=>[r(F,{items:s(O),label:"Priorität",required:"","error-messages":s(l).errors.priority,modelValue:s(l).priority,"onUpdate:modelValue":a[2]||(a[2]=e=>s(l).priority=e)},{selection:t(({item:e})=>[u(z(e.raw.title)+" ",1),r(p,{class:"ms-2",icon:e.raw.icon,color:e.raw.color},null,8,["icon","color"])]),item:t(({props:e,item:b})=>[r(M,$(j(e)),{append:t(()=>[r(p,{icon:b.raw.icon,color:b.raw.color},null,8,["icon","color"])]),_:2},1040)]),_:1},8,["items","error-messages","modelValue"])]),_:1}),r(o,{cols:"12"},{default:t(()=>[r(n,{label:"Zuweisung",required:"",multiple:"",chips:"",items:i.users.map(e=>({value:e.id,title:`${e.first_name} ${e.last_name}`,props:{subtitle:e.job_role??""}})),"error-messages":s(l).errors.assignees,modelValue:s(l).assignees,"onUpdate:modelValue":a[3]||(a[3]=e=>s(l).assignees=e)},null,8,["items","error-messages","modelValue"])]),_:1}),r(o,{cols:"12",md:"7"},{default:t(()=>[r(d,{label:"Betreff",required:"","error-messages":s(l).errors.title,modelValue:s(l).title,"onUpdate:modelValue":a[4]||(a[4]=e=>s(l).title=e)},null,8,["error-messages","modelValue"])]),_:1}),r(o,{cols:"12",md:"5"},{default:t(()=>[r(d,{label:"Termin (optional)",type:"datetime-local",modelValue:s(l).appointment_at,"onUpdate:modelValue":a[5]||(a[5]=e=>s(l).appointment_at=e),"error-Messages":s(l).errors.appointment_at},null,8,["modelValue","error-Messages"])]),_:1}),r(o,{cols:"12"},{default:t(()=>[r(g,{label:"Beschreibung",reqiuired:"","error-messages":s(l).errors.description,modelValue:s(l).description,"onUpdate:modelValue":a[6]||(a[6]=e=>s(l).description=e)},null,8,["error-messages","modelValue"])]),_:1})]),_:1})]),_:1}),r(w,{value:"expressTicket"},{default:t(()=>[r(S,null,{default:t(()=>[r(o,{cols:"12"},{default:t(()=>[r(n,{label:"Kunde wählen",required:"",items:i.customers.map(e=>({value:e.id,title:e.name})),modelValue:s(l).customer_id,"onUpdate:modelValue":a[7]||(a[7]=e=>s(l).customer_id=e),"error-messages":s(l).errors.customer_id},null,8,["items","modelValue","error-messages"])]),_:1}),r(o,{cols:"12",md:"6"},{default:t(()=>[r(d,{label:"Start",type:"datetime-local","model-value":s(l).start,"onUpdate:modelValue":a[8]||(a[8]=e=>s(l).start=e),"error-messages":s(l).errors.start,required:""},null,8,["model-value","error-messages"])]),_:1}),r(o,{cols:"12",md:"6"},{default:t(()=>[r(d,{type:"time",label:"Auftragsdauer (in Stunden)",min:"0",modelValue:s(l).duration,"onUpdate:modelValue":a[9]||(a[9]=e=>s(l).duration=e),"error-messages":s(l).errors.duration},null,8,["modelValue","error-messages"])]),_:1}),r(o,{cols:"12"},{default:t(()=>[r(n,{label:"Standort",modelValue:s(l).operatingSite,"onUpdate:modelValue":a[10]||(a[10]=e=>s(l).operatingSite=e),items:i.operatingSites.filter(e=>!("customer_id"in e)||e.customer_id===s(l).customer_id).map(e=>({...e,props:{subtitle:"address"in e?s(L)(e.address):""}})),"error-messages":s(l).errors.operatingSite},null,8,["modelValue","items","error-messages"])]),_:1}),r(o,{cols:"12"},{default:t(()=>[r(d,{label:"Betreff",required:"","error-messages":s(l).errors.title,modelValue:s(l).title,"onUpdate:modelValue":a[11]||(a[11]=e=>s(l).title=e)},null,8,["error-messages","modelValue"])]),_:1}),r(o,{cols:"12"},{default:t(()=>[r(g,{"auto-grow":"",label:"Beschreibung",required:"","error-messages":s(l).errors.description,modelValue:s(l).description,"onUpdate:modelValue":a[12]||(a[12]=e=>s(l).description=e)},null,8,["error-messages","modelValue"])]),_:1}),r(o,{cols:"12"},{default:t(()=>[r(g,{rows:"1",label:"Ressourcen","error-messages":s(l).errors.resources,modelValue:s(l).resources,"onUpdate:modelValue":a[13]||(a[13]=e=>s(l).resources=e),"auto-grow":""},null,8,["error-messages","modelValue"])]),_:1}),r(o,{cols:"12"},{default:t(()=>[r(E,{label:"Dateien anhängen",multiple:"",modelValue:s(l).files,"onUpdate:modelValue":a[14]||(a[14]=e=>s(l).files=e),"error-messages":s(l).errors["files.0"],accept:"image/jpg, image/png, image/jpeg, image/avif, image/tiff, image/svg+xml, application/pdf"},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),r(o,{cols:"12",class:"text-end"},{default:t(()=>[r(V,{type:"submit",color:"primary"},{default:t(()=>[...a[19]||(a[19]=[u("Speichern",-1)])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:2},1024)]),_:2},1024)]),_:1}))}});export{J as _};

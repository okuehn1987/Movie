import{d as w,r as F,w as c,a as n,b as d,S as k,e as a,g as o,V as S,i as x,L as z,f as g,M as m,N as U,h as l,P as D,a3 as B,U as T,t as i,a4 as I,a5 as K,m as p,p as N,q as b,K as M,R as v}from"./app-Uyw72iHo.js";const q=w({__name:"CreateEditCustomerNoteEntry",props:{selectedFolder:{},customer:{},customerNoteEntry:{}},setup(E){const f=E,y=F(!1),e=useForm({type:"text",title:null,value:null,file:null,selectedFolder:f.selectedFolder,metadata:[]});return c(y,r=>{if(!r)e.reset();else{const t=f.customerNoteEntry;t?(e.type=t.type??"",e.title=t.title??"",e.value=t.value??"",e.metadata=t.metadata??[]):e.reset()}}),c(()=>f.customerNoteEntry,r=>{r!=null&&r.metadata&&(e.metadata=[...r.metadata])},{immediate:!0}),(r,t)=>(d(),n(k,{"max-width":"1000",modelValue:y.value,"onUpdate:modelValue":t[5]||(t[5]=u=>y.value=u)},{activator:a(({props:u})=>[r.customerNoteEntry?(d(),n(p,v({key:0},u,{color:"primary",variant:"text",icon:"mdi-pencil"}),null,16)):(d(),n(p,v({key:1},u,{color:"primary",variant:"flat"}),{default:a(()=>[o(b,null,{default:a(()=>[...t[6]||(t[6]=[i("mdi-plus",-1)])]),_:1})]),_:1},16))]),default:a(({isActive:u})=>[o(M,{onSubmit:N(V=>{r.customerNoteEntry?l(e).transform(s=>({...s,_method:"patch"})).post(r.route("customerNoteEntry.update",{customerNoteEntry:r.customerNoteEntry.id}),{onSuccess:()=>{u.value=!1}}):l(e).transform(s=>({...s,metadata:s.metadata.length==0?null:s.metadata})).post(r.route("customer.customerNoteEntry.store",{customer:r.customer.id,selectedFolder:r.selectedFolder}),{onSuccess:()=>{u.value=!1}})},["prevent"])},{default:a(()=>{var V;return[o(S,{title:r.customerNoteEntry?'Kategorie "'+((V=r.customerNoteEntry)==null?void 0:V.title)+'" bearbeiten':"Notiz anlegen"},{append:a(()=>[o(p,{icon:"",variant:"text",onClick:N(()=>{u.value=!1},["stop"])},{default:a(()=>[o(b,null,{default:a(()=>[...t[7]||(t[7]=[i("mdi-close",-1)])]),_:1})]),_:1},8,["onClick"])]),default:a(()=>[o(x,null,{default:a(()=>[o(z,null,{default:a(()=>[o(m,{cols:"12"},{default:a(()=>[o(U,{label:"Anlegungstyp","model-value":l(e).type,"onUpdate:modelValue":t[0]||(t[0]=s=>{l(e).type=s,l(e).value="",l(e).file=null}),items:[{title:"Einzelnotiz",value:"text"},{title:"Datei",value:"file"}],"error-messages":l(e).errors.type},null,8,["model-value","error-messages"])]),_:1}),o(m,{cols:"12"},{default:a(()=>[o(D,{label:"Bezeichnung",modelValue:l(e).title,"onUpdate:modelValue":t[1]||(t[1]=s=>l(e).title=s),"error-messages":l(e).errors.title},null,8,["modelValue","error-messages"])]),_:1}),l(e).type=="text"?(d(),n(m,{key:0,cols:"12"},{default:a(()=>{var s;return[o(B,{label:"Inhalt",modelValue:l(e).value,"onUpdate:modelValue":t[2]||(t[2]=C=>l(e).value=C),"max-rows":"14","auto-grow":"","error-messages":l(e).errors.value},null,8,["modelValue","error-messages"]),((s=r.customerNoteEntry)==null?void 0:s.type)=="file"&&l(e).type=="text"?(d(),n(T,{key:0,type:"warning"},{default:a(()=>[...t[8]||(t[8]=[i(" Wird der Anlegungstyp auf „Einzelnotiz“ geändert, wird beim Speichern die zuvor vorhandene Datei gelöscht. ",-1)])]),_:1})):g("",!0)]}),_:1})):g("",!0),l(e).type=="file"?(d(),n(m,{key:1,cols:"12"},{default:a(()=>[o(I,{"prepend-icon":"","prepend-inner-icon":"mdi-paperclip",label:"Dateiupload",modelValue:l(e).file,"onUpdate:modelValue":t[3]||(t[3]=s=>l(e).file=s),"error-messages":l(e).errors.file},null,8,["modelValue","error-messages"])]),_:1})):g("",!0),o(m,{cols:"12"},{default:a(()=>[o(K,{label:"Suchbegriffe",autocomplete:"off",multiple:"",chips:"","closable-chips":"",clearable:"",modelValue:l(e).metadata,"onUpdate:modelValue":t[4]||(t[4]=s=>l(e).metadata=s),"error-messages":l(e).errors.metadata},null,8,["modelValue","error-messages"])]),_:1}),o(m,{cols:"12",class:"text-end"},{default:a(()=>[o(p,{color:"primary",variant:"flat",type:"submit"},{default:a(()=>[...t[9]||(t[9]=[i("Speichern",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:2},1032,["title"])]}),_:2},1032,["onSubmit"])]),_:1},8,["modelValue"]))}});export{q as _};

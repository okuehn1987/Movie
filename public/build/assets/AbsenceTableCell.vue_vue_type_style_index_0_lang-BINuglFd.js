import{d as h,c as _,D as f,j as c,o as i,q as m,i as b,e as g,t as k,n as v}from"./app-BEL-OU-Z.js";function C(a){return"patches_exists"in a&&a.patches_exists||"log"in a&&a.log.patches_exists?"hasOpenPatch":a.status==="created"?"created":a.status==="declined"?"declined":"accepted"}const S=["role","title"],w={key:0},L=h({__name:"AbsenceTableCell",props:{user:{},date:{},entries:{},absenceTypes:{},holidays:{}},setup(a){const t=a,n=_(()=>t.entries.find(e=>f.fromSQL(e.start)<=t.date&&t.date<=f.fromSQL(e.end)));function u(e){var r,o;const d=t.user.user_working_weeks.toSorted((s,l)=>l.active_since.localeCompare(s.active_since)).find(s=>s.active_since<=e.toFormat("yyyy-MM-dd"));return d&&d[(r=e.setLocale("en-US").weekdayLong)==null?void 0:r.toLowerCase()]&&!((o=t.holidays)!=null&&o[t.date.toFormat("yyyy-MM-dd")])}return(e,d)=>{var r,o,s;return i(),c("td",{class:v(["pa-0",{"editable-cell":e.can("absence","create",t.user)}]),role:e.can("absence","create",t.user)?"button":"cell",title:((r=t.holidays)==null?void 0:r[t.date.toFormat("yyyy-MM-dd")])??((o=e.absenceTypes.find(l=>{var p,y;return l.id==((y=(p=n.value)==null?void 0:p.absence_type)==null?void 0:y.id)}))==null?void 0:o.name)},[n.value&&u(e.date)?(i(),c("div",{key:0,class:"h-100 w-100 d-flex justify-center align-center",style:m({backgroundColor:{accepted:"#f99",created:"#99f",declined:"grey",hasOpenPatch:"#ff9"}[b(C)(n.value)]})},[n.value.absence_type_id?(i(),c("span",w,k((s=n.value.absence_type)==null?void 0:s.abbreviation),1)):g("",!0)],4)):(i(),c("div",{key:1,style:m({backgroundColor:u(e.date)?"":"lightgray"}),class:"h-100 w-100 empty"},null,4))],10,S)}}});export{L as _,C as g};

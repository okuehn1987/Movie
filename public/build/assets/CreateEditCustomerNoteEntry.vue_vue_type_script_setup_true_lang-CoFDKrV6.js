import{d as w,r as F,w as c,a as n,o as d,Q as k,b as a,f as r,V as S,g as x,K as z,e as g,L as m,M as U,i as l,O as D,a1 as B,S as T,s as i,a2 as I,a3 as K,l as p,m as b,p as v,J as M,P as E}from"./app-FvyjwAo0.js";const J=w({__name:"CreateEditCustomerNoteEntry",props:{selectedFolder:{},customer:{},customerNoteEntry:{}},setup(N){const f=N,y=F(!1),e=useForm({type:"text",title:null,value:null,file:null,selectedFolder:f.selectedFolder,metadata:[]});return c(y,o=>{if(!o)e.reset();else{const t=f.customerNoteEntry;t?(e.type=t.type??"",e.title=t.title??"",e.value=t.value??"",e.metadata=t.metadata??[]):e.reset()}}),c(()=>f.customerNoteEntry,o=>{o!=null&&o.metadata&&(e.metadata=[...o.metadata])},{immediate:!0}),(o,t)=>(d(),n(k,{"max-width":"1000",modelValue:y.value,"onUpdate:modelValue":t[5]||(t[5]=u=>y.value=u)},{activator:a(({props:u})=>[o.customerNoteEntry?(d(),n(p,E({key:0},u,{color:"primary",variant:"text",icon:"mdi-pencil"}),null,16)):(d(),n(p,E({key:1},u,{color:"primary",variant:"flat"}),{default:a(()=>[r(v,null,{default:a(()=>[...t[6]||(t[6]=[i("mdi-plus",-1)])]),_:1})]),_:1},16))]),default:a(({isActive:u})=>[r(M,{onSubmit:b(V=>{o.customerNoteEntry?l(e).transform(s=>({...s,_method:"patch"})).post(o.route("customerNoteEntry.update",{customerNoteEntry:o.customerNoteEntry.id}),{onSuccess:()=>{u.value=!1}}):l(e).transform(s=>({...s,metadata:s.metadata.length==0?null:s.metadata})).post(o.route("customer.customerNoteEntry.store",{customer:o.customer.id,selectedFolder:o.selectedFolder}),{onSuccess:()=>{u.value=!1}})},["prevent"])},{default:a(()=>{var V;return[r(S,{title:o.customerNoteEntry?'Kategorie "'+((V=o.customerNoteEntry)==null?void 0:V.title)+'" bearbeiten':"Notiz anlegen"},{append:a(()=>[r(p,{icon:"",variant:"text",onClick:b(()=>{u.value=!1},["stop"])},{default:a(()=>[r(v,null,{default:a(()=>[...t[7]||(t[7]=[i("mdi-close",-1)])]),_:1})]),_:1},8,["onClick"])]),default:a(()=>[r(x,null,{default:a(()=>[r(z,null,{default:a(()=>[r(m,{cols:"12"},{default:a(()=>[r(U,{label:"Anlegungstyp","model-value":l(e).type,"onUpdate:modelValue":t[0]||(t[0]=s=>{l(e).type=s,l(e).value="",l(e).file=null}),items:[{title:"Einzelnotiz",value:"text"},{title:"Datei",value:"file"}],"error-messages":l(e).errors.type},null,8,["model-value","error-messages"])]),_:1}),r(m,{cols:"12"},{default:a(()=>[r(D,{label:"Bezeichnung",modelValue:l(e).title,"onUpdate:modelValue":t[1]||(t[1]=s=>l(e).title=s),"error-messages":l(e).errors.title},null,8,["modelValue","error-messages"])]),_:1}),l(e).type=="text"?(d(),n(m,{key:0,cols:"12"},{default:a(()=>{var s;return[r(B,{label:"Inhalt",modelValue:l(e).value,"onUpdate:modelValue":t[2]||(t[2]=C=>l(e).value=C),"max-rows":"14","auto-grow":"","error-messages":l(e).errors.value},null,8,["modelValue","error-messages"]),((s=o.customerNoteEntry)==null?void 0:s.type)=="file"&&l(e).type=="text"?(d(),n(T,{key:0,type:"warning"},{default:a(()=>[...t[8]||(t[8]=[i(" Wird der Anlegungstyp auf „Einzelnotiz“ geändert, wird beim Speichern die zuvor vorhandene Datei gelöscht. ",-1)])]),_:1})):g("",!0)]}),_:1})):g("",!0),l(e).type=="file"?(d(),n(m,{key:1,cols:"12"},{default:a(()=>[r(I,{"prepend-icon":"","prepend-inner-icon":"mdi-paperclip",label:"Dateiupload",modelValue:l(e).file,"onUpdate:modelValue":t[3]||(t[3]=s=>l(e).file=s),"error-messages":l(e).errors.file},null,8,["modelValue","error-messages"])]),_:1})):g("",!0),r(m,{cols:"12"},{default:a(()=>[r(K,{label:"Suchbegriffe",autocomplete:"off",multiple:"",chips:"","closable-chips":"",clearable:"",modelValue:l(e).metadata,"onUpdate:modelValue":t[4]||(t[4]=s=>l(e).metadata=s),"error-messages":l(e).errors.metadata},null,8,["modelValue","error-messages"])]),_:1}),r(m,{cols:"12",class:"text-end"},{default:a(()=>[r(p,{color:"primary",variant:"flat",type:"submit"},{default:a(()=>[...t[9]||(t[9]=[i("Speichern",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:2},1032,["title"])]}),_:2},1032,["onSubmit"])]),_:1},8,["modelValue"]))}});export{J as _};

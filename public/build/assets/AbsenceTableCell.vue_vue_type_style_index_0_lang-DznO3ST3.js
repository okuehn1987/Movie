import{d as v,c as h,D as l,k as u,b as f,j as _,f as b,v as k,h as M,g as C,e as w,t as S,q as O,s as F,n as D}from"./app-BLqB0iZk.js";function L(a){return"patches_exists"in a&&a.patches_exists||"log"in a&&a.log.patches_exists?"hasOpenPatch":a.status==="created"?"created":a.status==="declined"?"declined":"accepted"}const T=["role","title"],V={key:0,class:"h-100 w-100 d-flex justify-center align-center"},E={key:1,title:"Geburtstag"},j=v({__name:"AbsenceTableCell",props:{user:{},date:{},entries:{},absenceTypes:{},holidays:{},homeOfficeDays:{}},setup(a){const e=a,s=h(()=>e.entries.find(t=>l.fromSQL(t.start)<=e.date&&e.date<=l.fromSQL(t.end)));function c(t){var o,d;const n=e.user.user_working_weeks.toSorted((r,i)=>i.active_since.localeCompare(r.active_since)).find(r=>r.active_since<=t.toFormat("yyyy-MM-dd"));return n&&n[(o=t.setLocale("en-US").weekdayLong)==null?void 0:o.toLowerCase()]&&!((d=e.holidays)!=null&&d[e.date.toFormat("yyyy-MM-dd")])}function g(){return s.value&&c(e.date)?{accepted:"#f99",created:"#99f",declined:"grey",hasOpenPatch:"#99f"}[L(s.value)]:c(e.date)&&y.value?{accepted:"#ff9",created:"#99f",declined:"grey"}[y.value.status]:c(e.date)?"":"lightgray"}const y=h(()=>e.homeOfficeDays.find(t=>t.date===e.date.toFormat("yyyy-MM-dd")));return(t,n)=>{var o,d,r;return f(),u("td",{class:D(["pa-0",{"editable-cell":t.can("absence","create",e.user)}]),role:t.can("absence","create",e.user)?"button":"cell",title:((o=e.holidays)==null?void 0:o[e.date.toFormat("yyyy-MM-dd")])??((d=t.absenceTypes.find(i=>{var m,p;return i.id==((p=(m=s.value)==null?void 0:m.absence_type)==null?void 0:p.id)}))==null?void 0:d.name)},[_("div",{class:"w-100 h-100 d-flex justify-center align-center flex-column",style:F({backgroundColor:g()})},[s.value&&c(t.date)&&s.value.absence_type_id?(f(),u("div",V,[_("span",null,k((r=s.value.absence_type)==null?void 0:r.abbreviation),1)])):b("",!0),t.user.date_of_birth_marker&&t.date.toFormat("MM-dd")===M(l).fromISO(t.user.date_of_birth_marker).toFormat("MM-dd")?(f(),u("div",E,[C(O,null,{default:w(()=>[...n[0]||(n[0]=[S("mdi-crown",-1)])]),_:1})])):b("",!0)],4)],10,T)}}});export{j as _,L as g};

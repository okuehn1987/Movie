import{d as B,r as m,i as R,o as f,f as a,a as v,e as y,b as t,Y as x,j as r,D as d,X as U,V as N,v as T,g as L,N as D,O as u,M as Q,h as M,t as p,P as b,l as V,m as C,q as g,n as P,J as Y,F as $,z as j}from"./app-CDxl7bQp.js";const E=B({__name:"AbsenceRequests",props:{absenceRequests:{}},setup(_){var w;const c=_,s=m(((w=c.absenceRequests)==null?void 0:w.find(n=>n.id==Number(route().params.openAbsence)))??null),o=m(!!s.value),F=m(!1),i=m(1);function S(n,e){var A;const l=(A=c.absenceRequests)==null?void 0:A.find(q=>q.id===e.item.id);l&&(s.value=l,o.value=!0)}function k(n){s.value&&j.patch(route("absence.updateStatus",{absence:s.value.id}),{accepted:n},{onSuccess:()=>{o.value=!1,F.value=!0}})}return(n,e)=>(f(),R($,null,[a(U,{hover:"","items-per-page":"5",page:i.value,"onUpdate:page":e[1]||(e[1]=l=>i.value=l),"no-data-text":"keine Abwesenheitsanträge vorhanden.","onClick:row":S,items:n.absenceRequests.map(l=>({id:l.id,user:l.user.first_name+" "+l.user.last_name,start:r(d).fromSQL(l.start).toFormat("dd.MM.yyyy"),end:r(d).fromSQL(l.end).toFormat("dd.MM.yyyy")})),headers:[{title:"Mitarbeiter",key:"user"},{title:"Von",key:"start"},{title:"Bis",key:"end"}]},{bottom:t(()=>[n.absenceRequests.length>5?(f(),v(x,{key:0,modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=l=>i.value=l),length:Math.ceil(n.absenceRequests.length/5)},null,8,["modelValue","length"])):y("",!0)]),_:1},8,["page","items"]),s.value?(f(),v(Y,{key:0,modelValue:o.value,"onUpdate:modelValue":e[6]||(e[6]=l=>o.value=l),"max-width":"1000"},{default:t(()=>[a(N,{title:"Abwesenheit von "+s.value.user.first_name+" "+s.value.user.last_name},{append:t(()=>[a(V,{icon:"",variant:"text",onClick:e[2]||(e[2]=l=>o.value=!1)},{default:t(()=>[a(P,null,{default:t(()=>[...e[7]||(e[7]=[g("mdi-close",-1)])]),_:1})]),_:1})]),default:t(()=>[a(T),a(L,null,{default:t(()=>[a(D,null,{default:t(()=>[s.value.absence_type.name=="Urlaub"?(f(),v(u,{key:0,cols:"12"},{default:t(()=>[a(Q,{type:s.value.user.leaveDaysForYear<s.value.usedDays?"warning":"info",class:"w-100"},{default:t(()=>[a(D,null,{default:t(()=>[a(u,{cols:"12",md:"6"},{default:t(()=>[M("div",null,"Verfügbare Urlaubstage "+p(r(d).now().year)+": "+p(s.value.user.leaveDaysForYear),1)]),_:1}),a(u,{cols:"12",md:"6"},{default:t(()=>[M("div",null,"Benötigte Urlaubstage: "+p(s.value.usedDays),1)]),_:1})]),_:1})]),_:1},8,["type"])]),_:1})):y("",!0),a(u,{cols:"12"},{default:t(()=>[a(b,{label:"Abwesenheitsgrund",modelValue:s.value.absence_type.name,"onUpdate:modelValue":e[3]||(e[3]=l=>s.value.absence_type.name=l),readonly:""},null,8,["modelValue"])]),_:1}),a(u,{cols:"12",md:"6"},{default:t(()=>[a(b,{label:"Von:","model-value":r(d).fromSQL(s.value.start).toFormat("dd.MM.yyyy"),readonly:""},null,8,["model-value"])]),_:1}),a(u,{cols:"12",md:"6"},{default:t(()=>[a(b,{label:"Bis:","model-value":r(d).fromSQL(s.value.end).toFormat("dd.MM.yyyy"),readonly:""},null,8,["model-value"])]),_:1})]),_:1})]),_:1}),a(u,{cols:"12",class:"d-flex justify-end ga-3"},{default:t(()=>[a(V,{color:"error",onClick:e[4]||(e[4]=C(l=>k(!1),["stop"]))},{default:t(()=>[...e[8]||(e[8]=[g("Ablehnen",-1)])]),_:1}),a(V,{color:"success",onClick:e[5]||(e[5]=C(l=>k(!0),["stop"]))},{default:t(()=>[...e[9]||(e[9]=[g("Akzeptieren",-1)])]),_:1})]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])):y("",!0)],64))}});export{E as _};

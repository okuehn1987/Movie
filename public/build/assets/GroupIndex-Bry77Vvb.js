import{d as h,P,T as w,r as N,o as g,c as V,w as e,b as a,y as _,u as t,q as S,e as u,R as T,f as b,V as y,g as k,h as B,k as A,l as D,m as F,n as m,B as M,p as R,s as c,J as U,S as $,j as E,D as G}from"./app-TBYsx7aB.js";import{_ as I}from"./AdminLayout.vue_vue_type_script_setup_true_lang-BXdDuvXF.js";import{a as j,f as q}from"./utils-CgDEyJad.js";const z=["colspan"],W=h({__name:"GroupIndex",props:{groups:{},users:{}},setup(x){const v=x,{currentPage:d,lastPage:p,data:C}=j(P(v),"groups"),o=w({name:"",users:[]}),f=N([]);return(i,l)=>(g(),V(I,{title:"Abteilungen"},{default:e(()=>[a(y,null,{default:e(()=>[a(_,{headers:[{title:"#",key:"id"},{title:"Abteilungsname",key:"name"},{title:"",key:"data-table-expand",align:"end"}],items:t(C),expanded:f.value,"onUpdate:expanded":l[3]||(l[3]=r=>f.value=r)},{"header.data-table-expand":e(()=>[a(S,{"max-width":"1000"},{activator:e(({props:r})=>[a(u,T(r,{color:"primary"}),{default:e(()=>[a(b,{icon:"mdi-plus"})]),_:2},1040)]),default:e(({isActive:r})=>[a(y,{title:"Abteilung erstellen"},{append:e(()=>[a(u,{icon:"",variant:"text",onClick:s=>r.value=!1},{default:e(()=>[a(b,null,{default:e(()=>l[4]||(l[4]=[k("mdi-close")])),_:1})]),_:2},1032,["onClick"])]),default:e(()=>[a(B,null,{default:e(()=>[a(A,{onSubmit:D(s=>{t(o).post(i.route("group.store"),{onSuccess:()=>{t(o).reset(),r.value=!1}})},["prevent"])},{default:e(()=>[a(F,null,{default:e(()=>[a(m,{cols:"12",sm:"6"},{default:e(()=>[a(M,{modelValue:t(o).name,"onUpdate:modelValue":l[0]||(l[0]=s=>t(o).name=s),"error-messages":t(o).errors.name,label:"Abteilungsname"},null,8,["modelValue","error-messages"])]),_:1}),a(m,{cols:"12",sm:"6"},{default:e(()=>[a(R,{modelValue:t(o).users,"onUpdate:modelValue":l[1]||(l[1]=s=>t(o).users=s),"error-messages":t(o).errors.users,items:i.users.map(s=>({...s,name:s.first_name+" "+s.last_name})),"item-title":"name","item-value":"id",label:"Wähle Mitarbeiter aus, die zur Abteilung gehören",multiple:""},null,8,["modelValue","error-messages","items"])]),_:1}),a(m,{cols:"12",class:"text-end"},{default:e(()=>[a(u,{loading:t(o).processing,type:"submit",color:"primary"},{default:e(()=>l[5]||(l[5]=[k("Erstellen")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:2},1032,["onSubmit"])]),_:2},1024)]),_:2},1024)]),_:1})]),"expanded-row":e(({columns:r,item:s})=>[c("tr",null,[c("td",{colspan:r.length,style:{padding:"0"}},[a(_,{class:"bg-secondary",headers:[{title:"#",key:"id"},{title:"Vorname",key:"first_name"},{title:"Nachname",key:"last_name"},{title:"Email",key:"email"},{title:"Personalnummer",key:"staff_number"},{title:"Geburtsdatum",key:"date_of_birth"}],items:i.users.filter(n=>n.group_id==s.id).map(n=>({...t(q)(n),date_of_birth:t(G).fromSQL(n.date_of_birth).toFormat("dd.MM.yyyy")}))},null,8,["items"])],8,z)])]),bottom:e(()=>[t(p)>1?(g(),V(U,{key:0,modelValue:t(d),"onUpdate:modelValue":l[2]||(l[2]=r=>$(d)?d.value=r:null),length:t(p)},null,8,["modelValue","length"])):E("",!0)]),_:1},8,["items","expanded"])]),_:1})]),_:1}))}});export{W as default};

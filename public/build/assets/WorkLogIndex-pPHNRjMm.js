import{A as d}from"./AdminLayout-dH0f1CFK.js";import{k as f,c as k}from"./utils-BHCeikZt.js";import{d as g,a as l,o as i,b as r,f as n,y as h,i as o,D as y,q as w,T as b,l as p,j as B,e as c,F as T,p as s,s as L,t as x}from"./app-9FOu14I-.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const W=g({__name:"WorkLogIndex",props:{users:{}},setup(z){function a(t){var m;return t.current_working_hours?Math.round(t.default_time_account.balance/3600/(((m=t.current_working_hours)==null?void 0:m.weekly_working_hours)/t.userWorkingWeekCount)*10)/10:null}return(t,m)=>(i(),l(d,{title:"Arbeitszeiten"},{default:r(()=>[n(h,{style:w({maxHeight:o(f)(0)}),"fixed-header":"",hover:"",items:t.users.map(e=>({...e,timeAccountBalance:e.default_time_account.balance,lastAction:e.latest_work_log.end?"Gehen":"Kommen",time:o(y).fromSQL(e.latest_work_log.end?e.latest_work_log.end:e.latest_work_log.start).toFormat("dd.MM.yyyy HH:mm"),timeBalanceTrafficLight:e.time_balance_red_threshold!==null&&e.time_balance_yellow_threshold!==null?Math.abs(e.default_time_account.balance)>=e.time_balance_red_threshold*3600?"error":Math.abs(e.default_time_account.balance)>=e.time_balance_yellow_threshold*3600?"warning":"success":null,userWorkingWeekCount:Object.entries(e.current_working_week??{}).filter(([u,_])=>["monday","tuesday","wednesday","thursday","friday","saturday","sunday"].includes(u)&&_).length})),headers:[{title:"",key:"isPresent",sortable:!1},{title:"Vorname",key:"first_name"},{title:"Nachname",key:"last_name"},{title:"Letzte Buchung",key:"lastAction"},{title:"Uhrzeit",key:"time"},{title:"Gleitzeitkonto",key:"timeAccountBalance",align:"end"},{title:"",key:"timeBalanceTrafficLight"},{title:"",key:"actions",sortable:!1,align:"end"}]},{"item.isPresent":r(({item:e})=>[n(s,{icon:"mdi-circle",color:e.latest_work_log.end?"error":"success",size:"md"},null,8,["color"])]),"item.timeAccountBalance":r(({item:e})=>[L(x(o(k)(e.default_time_account.balance)),1)]),"item.timeBalanceTrafficLight":r(({item:e})=>[e.timeBalanceTrafficLight?(i(),B(T,{key:0},[e.timeBalanceTrafficLight==="success"?(i(),l(s,{key:0,icon:"mdi-clock-time-three",color:"success",size:"x-large",title:a(e)?a(e)+" PT":"/"},null,8,["title"])):c("",!0),e.timeBalanceTrafficLight==="warning"?(i(),l(s,{key:1,icon:"mdi-clock-time-five",color:"warning",size:"x-large",title:a(e)?a(e)+" PT":"/"},null,8,["title"])):c("",!0),e.timeBalanceTrafficLight==="error"?(i(),l(s,{key:2,icon:"mdi-clock-time-nine",color:"error",size:"x-large",title:a(e)?a(e)+" PT":"/"},null,8,["title"])):c("",!0)],64)):c("",!0)]),"item.actions":r(({item:e})=>[n(o(b),{href:t.route("user.workLog.index",{user:e.id,fromUserWorkLogs:!0})},{default:r(()=>[n(p,{color:"primary",variant:"text",icon:"mdi-eye"})]),_:1},8,["href"])]),_:1},8,["style","items"])]),_:1}))}});export{W as default};

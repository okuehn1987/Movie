import{d as y,R as _,w as T,a as k,o as q,Q as C,b as o,f as l,x as I,E as P,i as s,G as w,s as u,g as B,J as A,m as R,H as D,I as v,K as S,L as t,N as n,M as F,ab as M,a7 as $,a8 as j,p,t as z,O as d,a1 as g,a2 as E,l as V,V as K,P as N}from"./app-D_msUg6M.js";import{P as O}from"./types-BVvW7sCV.js";import{f as L}from"./utils-CjWaPQ3U.js";const J=y({__name:"TicketCreateDialog",props:{customers:{},users:{},operatingSites:{}},setup(c){var f;const x=c,r=useForm({title:"",description:"",priority:"medium",customer_id:null,assignees:[_().props.auth.user.id],start:null,duration:"00:00",operatingSite:(f=x.operatingSites.find(i=>i.value.type==="App\\Models\\OperatingSite"))==null?void 0:f.value,resources:"",appointment_at:null,files:[],tab:"ticket"});function U(i){r.post(route("ticket.store"),{onSuccess:()=>{r.reset(),i.value=!1}})}return T(()=>r.customer_id,()=>{r.reset("operatingSite")}),(i,a)=>(q(),k(C,{"max-width":"600px"},{activator:o(({props:m})=>[l(V,N({title:"Auftrag erstellen"},m,{color:"primary"}),{default:o(()=>[l(p,{icon:"mdi-plus"})]),_:1},16)]),default:o(({isActive:m})=>[l(K,{title:"Auftrag hinzufügen"},{append:o(()=>[l(V,{icon:"",variant:"text",onClick:e=>m.value=!1},{default:o(()=>[l(p,null,{default:o(()=>[...a[16]||(a[16]=[u("mdi-close",-1)])]),_:1})]),_:1},8,["onClick"])]),default:o(()=>[l(I),l(P,{modelValue:s(r).tab,"onUpdate:modelValue":a[0]||(a[0]=e=>s(r).tab=e)},{default:o(()=>[l(w,{class:"w-50",value:"ticket"},{default:o(()=>[...a[17]||(a[17]=[u("Auftrag",-1)])]),_:1}),l(w,{class:"w-50",value:"expressTicket"},{default:o(()=>[...a[18]||(a[18]=[u("Einzelauftrag",-1)])]),_:1})]),_:1},8,["modelValue"]),l(B,{style:{"max-height":"750px","overflow-y":"auto"}},{default:o(()=>[l(A,{onSubmit:R(e=>U(m),["prevent"])},{default:o(()=>[l(D,{modelValue:s(r).tab,"onUpdate:modelValue":a[15]||(a[15]=e=>s(r).tab=e)},{default:o(()=>[l(v,{value:"ticket"},{default:o(()=>[l(S,null,{default:o(()=>[l(t,{cols:"12",md:"8"},{default:o(()=>[l(n,{label:"Kunde wählen",required:"",items:i.customers.map(e=>({value:e.id,title:e.name})),modelValue:s(r).customer_id,"onUpdate:modelValue":a[1]||(a[1]=e=>s(r).customer_id=e),"error-messages":s(r).errors.customer_id},null,8,["items","modelValue","error-messages"])]),_:1}),l(t,{cols:"12",md:"4"},{default:o(()=>[l(F,{items:s(O),label:"Priorität",required:"","error-messages":s(r).errors.priority,modelValue:s(r).priority,"onUpdate:modelValue":a[2]||(a[2]=e=>s(r).priority=e)},{selection:o(({item:e})=>[u(z(e.raw.title)+" ",1),l(p,{class:"ms-2",icon:e.raw.icon,color:e.raw.color},null,8,["icon","color"])]),item:o(({props:e,item:b})=>[l(M,$(j(e)),{append:o(()=>[l(p,{icon:b.raw.icon,color:b.raw.color},null,8,["icon","color"])]),_:2},1040)]),_:1},8,["items","error-messages","modelValue"])]),_:1}),l(t,{cols:"12"},{default:o(()=>[l(n,{label:"Zuweisung",required:"",multiple:"",chips:"",items:i.users.map(e=>({value:e.id,title:`${e.first_name} ${e.last_name}`,props:{subtitle:e.job_role??""}})),"error-messages":s(r).errors.assignees,modelValue:s(r).assignees,"onUpdate:modelValue":a[3]||(a[3]=e=>s(r).assignees=e)},null,8,["items","error-messages","modelValue"])]),_:1}),l(t,{cols:"12",md:"7"},{default:o(()=>[l(d,{label:"Betreff",required:"","error-messages":s(r).errors.title,modelValue:s(r).title,"onUpdate:modelValue":a[4]||(a[4]=e=>s(r).title=e)},null,8,["error-messages","modelValue"])]),_:1}),l(t,{cols:"12",md:"5"},{default:o(()=>[l(d,{label:"Termin (optional)",type:"datetime-local",modelValue:s(r).appointment_at,"onUpdate:modelValue":a[5]||(a[5]=e=>s(r).appointment_at=e),"error-Messages":s(r).errors.appointment_at},null,8,["modelValue","error-Messages"])]),_:1}),l(t,{cols:"12"},{default:o(()=>[l(g,{label:"Beschreibung",reqiuired:"","error-messages":s(r).errors.description,modelValue:s(r).description,"onUpdate:modelValue":a[6]||(a[6]=e=>s(r).description=e),"max-rows":"13","auto-grow":""},null,8,["error-messages","modelValue"])]),_:1})]),_:1})]),_:1}),l(v,{value:"expressTicket"},{default:o(()=>[l(S,null,{default:o(()=>[l(t,{cols:"12"},{default:o(()=>[l(n,{label:"Kunde wählen",required:"",items:i.customers.map(e=>({value:e.id,title:e.name})),modelValue:s(r).customer_id,"onUpdate:modelValue":a[7]||(a[7]=e=>s(r).customer_id=e),"error-messages":s(r).errors.customer_id},null,8,["items","modelValue","error-messages"])]),_:1}),l(t,{cols:"12",md:"6"},{default:o(()=>[l(d,{label:"Start",type:"datetime-local","model-value":s(r).start,"onUpdate:modelValue":a[8]||(a[8]=e=>s(r).start=e),"error-messages":s(r).errors.start,required:""},null,8,["model-value","error-messages"])]),_:1}),l(t,{cols:"12",md:"6"},{default:o(()=>[l(d,{type:"time",label:"Auftragsdauer (in Stunden)",min:"0",modelValue:s(r).duration,"onUpdate:modelValue":a[9]||(a[9]=e=>s(r).duration=e),"error-messages":s(r).errors.duration},null,8,["modelValue","error-messages"])]),_:1}),l(t,{cols:"12"},{default:o(()=>[l(n,{label:"Standort",modelValue:s(r).operatingSite,"onUpdate:modelValue":a[10]||(a[10]=e=>s(r).operatingSite=e),items:i.operatingSites.filter(e=>!("customer_id"in e)||e.customer_id===s(r).customer_id).map(e=>({...e,props:{subtitle:"address"in e?s(L)(e.address):""}})),"error-messages":s(r).errors.operatingSite},null,8,["modelValue","items","error-messages"])]),_:1}),l(t,{cols:"12"},{default:o(()=>[l(d,{label:"Betreff",required:"","error-messages":s(r).errors.title,modelValue:s(r).title,"onUpdate:modelValue":a[11]||(a[11]=e=>s(r).title=e)},null,8,["error-messages","modelValue"])]),_:1}),l(t,{cols:"12"},{default:o(()=>[l(g,{label:"Beschreibung",required:"","max-rows":"10",rows:"2","auto-grow":"","error-messages":s(r).errors.description,modelValue:s(r).description,"onUpdate:modelValue":a[12]||(a[12]=e=>s(r).description=e)},null,8,["error-messages","modelValue"])]),_:1}),l(t,{cols:"12"},{default:o(()=>[l(g,{"max-rows":"5","auto-grow":"",rows:"2",label:"Ressourcen","error-messages":s(r).errors.resources,modelValue:s(r).resources,"onUpdate:modelValue":a[13]||(a[13]=e=>s(r).resources=e)},null,8,["error-messages","modelValue"])]),_:1}),l(t,{cols:"12"},{default:o(()=>[l(E,{label:"Dateien anhängen",multiple:"",modelValue:s(r).files,"onUpdate:modelValue":a[14]||(a[14]=e=>s(r).files=e),"error-messages":s(r).errors["files.0"],accept:"image/jpg, image/png, image/jpeg, image/avif, image/tiff, image/svg+xml, application/pdf"},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(t,{cols:"12",class:"text-end"},{default:o(()=>[l(V,{type:"submit",color:"primary"},{default:o(()=>[...a[19]||(a[19]=[u("Speichern",-1)])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:2},1024)]),_:2},1024)]),_:1}))}});export{J as _};

import{d as T,R as _,w as k,a as q,o as C,Q as I,b as o,f as s,x as P,E as B,i as r,G as w,s as u,g as A,J as D,m as R,H as j,I as v,K as S,L as t,N as n,M as F,ab as M,a7 as $,a8 as z,p,t as E,O as d,a1 as g,a2 as x,l as f,V as K,P as N}from"./app-DNlcDO81.js";import{P as O}from"./types-BVvW7sCV.js";import{f as L}from"./utils-Dc_10cYE.js";const J=T({__name:"TicketCreateDialog",props:{customers:{},users:{},operatingSites:{}},setup(U){var V;const c=U,l=useForm({title:"",description:"",priority:"medium",customer_id:null,assignees:[_().props.auth.user.id],start:null,duration:"00:00",operatingSite:(V=c.operatingSites.find(i=>i.value.type==="App\\Models\\OperatingSite"))==null?void 0:V.value,resources:"",appointment_at:null,files:[],tab:"ticket"});function y(i){l.post(route("ticket.store"),{onSuccess:()=>{l.reset(),i.value=!1}})}return k(()=>l.customer_id,()=>{l.reset("operatingSite")}),(i,a)=>(C(),q(I,{"max-width":"600px"},{activator:o(({props:m})=>[s(f,N({title:"Auftrag erstellen"},m,{color:"primary"}),{default:o(()=>[s(p,{icon:"mdi-plus"})]),_:1},16)]),default:o(({isActive:m})=>[s(K,{title:"Auftrag hinzufügen"},{append:o(()=>[s(f,{icon:"",variant:"text",onClick:e=>m.value=!1},{default:o(()=>[s(p,null,{default:o(()=>[...a[17]||(a[17]=[u("mdi-close",-1)])]),_:1})]),_:1},8,["onClick"])]),default:o(()=>[s(P),s(B,{modelValue:r(l).tab,"onUpdate:modelValue":a[0]||(a[0]=e=>r(l).tab=e)},{default:o(()=>[s(w,{class:"w-50",value:"ticket"},{default:o(()=>[...a[18]||(a[18]=[u("Auftrag",-1)])]),_:1}),s(w,{class:"w-50",value:"expressTicket"},{default:o(()=>[...a[19]||(a[19]=[u("Einzelauftrag",-1)])]),_:1})]),_:1},8,["modelValue"]),s(A,{style:{"max-height":"750px","overflow-y":"auto"}},{default:o(()=>[s(D,{onSubmit:R(e=>y(m),["prevent"])},{default:o(()=>[s(j,{modelValue:r(l).tab,"onUpdate:modelValue":a[16]||(a[16]=e=>r(l).tab=e)},{default:o(()=>[s(v,{value:"ticket"},{default:o(()=>[s(S,null,{default:o(()=>[s(t,{cols:"12",md:"8"},{default:o(()=>[s(n,{label:"Kunde wählen",required:"",items:i.customers.map(e=>({value:e.id,title:e.name})),modelValue:r(l).customer_id,"onUpdate:modelValue":a[1]||(a[1]=e=>r(l).customer_id=e),"error-messages":r(l).errors.customer_id},null,8,["items","modelValue","error-messages"])]),_:1}),s(t,{cols:"12",md:"4"},{default:o(()=>[s(F,{items:r(O),label:"Priorität",required:"","error-messages":r(l).errors.priority,modelValue:r(l).priority,"onUpdate:modelValue":a[2]||(a[2]=e=>r(l).priority=e)},{selection:o(({item:e})=>[u(E(e.raw.title)+" ",1),s(p,{class:"ms-2",icon:e.raw.icon,color:e.raw.color},null,8,["icon","color"])]),item:o(({props:e,item:b})=>[s(M,$(z(e)),{append:o(()=>[s(p,{icon:b.raw.icon,color:b.raw.color},null,8,["icon","color"])]),_:2},1040)]),_:1},8,["items","error-messages","modelValue"])]),_:1}),s(t,{cols:"12"},{default:o(()=>[s(n,{label:"Zuweisung",required:"",multiple:"",chips:"",items:i.users.map(e=>({value:e.id,title:`${e.first_name} ${e.last_name}`,props:{subtitle:e.job_role??""}})),"error-messages":r(l).errors.assignees,modelValue:r(l).assignees,"onUpdate:modelValue":a[3]||(a[3]=e=>r(l).assignees=e)},null,8,["items","error-messages","modelValue"])]),_:1}),s(t,{cols:"12",md:"7"},{default:o(()=>[s(d,{label:"Betreff",required:"","error-messages":r(l).errors.title,modelValue:r(l).title,"onUpdate:modelValue":a[4]||(a[4]=e=>r(l).title=e)},null,8,["error-messages","modelValue"])]),_:1}),s(t,{cols:"12",md:"5"},{default:o(()=>[s(d,{label:"Termin (optional)",type:"datetime-local",modelValue:r(l).appointment_at,"onUpdate:modelValue":a[5]||(a[5]=e=>r(l).appointment_at=e),"error-Messages":r(l).errors.appointment_at},null,8,["modelValue","error-Messages"])]),_:1}),s(t,{cols:"12"},{default:o(()=>[s(g,{label:"Beschreibung",reqiuired:"","error-messages":r(l).errors.description,modelValue:r(l).description,"onUpdate:modelValue":a[6]||(a[6]=e=>r(l).description=e),"max-rows":"13","auto-grow":""},null,8,["error-messages","modelValue"])]),_:1}),s(t,{cols:"12"},{default:o(()=>[s(x,{label:"Dateien anhängen",multiple:"",modelValue:r(l).files,"onUpdate:modelValue":a[7]||(a[7]=e=>r(l).files=e),"error-messages":r(l).errors["files.0"],accept:"image/jpg, image/png, image/jpeg, image/avif, image/tiff, image/svg+xml, application/pdf"},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),s(v,{value:"expressTicket"},{default:o(()=>[s(S,null,{default:o(()=>[s(t,{cols:"12"},{default:o(()=>[s(n,{label:"Kunde wählen",required:"",items:i.customers.map(e=>({value:e.id,title:e.name})),modelValue:r(l).customer_id,"onUpdate:modelValue":a[8]||(a[8]=e=>r(l).customer_id=e),"error-messages":r(l).errors.customer_id},null,8,["items","modelValue","error-messages"])]),_:1}),s(t,{cols:"12",md:"6"},{default:o(()=>[s(d,{label:"Start",type:"datetime-local","model-value":r(l).start,"onUpdate:modelValue":a[9]||(a[9]=e=>r(l).start=e),"error-messages":r(l).errors.start,required:""},null,8,["model-value","error-messages"])]),_:1}),s(t,{cols:"12",md:"6"},{default:o(()=>[s(d,{type:"time",label:"Auftragsdauer (in Stunden)",min:"0",modelValue:r(l).duration,"onUpdate:modelValue":a[10]||(a[10]=e=>r(l).duration=e),"error-messages":r(l).errors.duration},null,8,["modelValue","error-messages"])]),_:1}),s(t,{cols:"12"},{default:o(()=>[s(n,{label:"Standort",modelValue:r(l).operatingSite,"onUpdate:modelValue":a[11]||(a[11]=e=>r(l).operatingSite=e),items:i.operatingSites.filter(e=>!("customer_id"in e)||e.customer_id===r(l).customer_id).map(e=>({...e,props:{subtitle:"address"in e?r(L)(e.address):""}})),"error-messages":r(l).errors.operatingSite},null,8,["modelValue","items","error-messages"])]),_:1}),s(t,{cols:"12"},{default:o(()=>[s(d,{label:"Betreff",required:"","error-messages":r(l).errors.title,modelValue:r(l).title,"onUpdate:modelValue":a[12]||(a[12]=e=>r(l).title=e)},null,8,["error-messages","modelValue"])]),_:1}),s(t,{cols:"12"},{default:o(()=>[s(g,{label:"Beschreibung",required:"","max-rows":"10",rows:"2","auto-grow":"","error-messages":r(l).errors.description,modelValue:r(l).description,"onUpdate:modelValue":a[13]||(a[13]=e=>r(l).description=e)},null,8,["error-messages","modelValue"])]),_:1}),s(t,{cols:"12"},{default:o(()=>[s(g,{"max-rows":"5","auto-grow":"",rows:"2",label:"Ressourcen","error-messages":r(l).errors.resources,modelValue:r(l).resources,"onUpdate:modelValue":a[14]||(a[14]=e=>r(l).resources=e)},null,8,["error-messages","modelValue"])]),_:1}),s(t,{cols:"12"},{default:o(()=>[s(x,{label:"Dateien anhängen",multiple:"",modelValue:r(l).files,"onUpdate:modelValue":a[15]||(a[15]=e=>r(l).files=e),"error-messages":r(l).errors["files.0"],accept:"image/jpg, image/png, image/jpeg, image/avif, image/tiff, image/svg+xml, application/pdf"},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(t,{cols:"12",class:"text-end"},{default:o(()=>[s(f,{type:"submit",color:"primary"},{default:o(()=>[...a[20]||(a[20]=[u("Speichern",-1)])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:2},1024)]),_:2},1024)]),_:1}))}});export{J as _};

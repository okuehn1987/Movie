import{d as z,a as m,b as d,S as X,e as o,g as t,V as _,y as K,i as ee,K as te,p as c,h as s,L as oe,M as I,P as U,a3 as ae,a4 as ne,m as f,t as b,q as h,j as p,a8 as re,a9 as se,u as W,T as Z,r as $,aa as ie,k as D,ab as le,B as g,ac as T,ad as M,R as ue,ae as pe,F as de,af as ce,o as me,w as P,ag as ge,c as ve,D as fe,Y as he,Z as be,ah as we,f as k,ai as ke,v as A,n as L,_ as O,aj as ye,$ as E,ak as R,al as Ie,am as Ce,s as Ve,U as j,an as q,ao as G,ap as Ae,aq as $e}from"./app-VJNhXN4_.js";import Me from"./ChatDetails-CbvF7JCQ.js";import{_ as x}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{s as H}from"./utils-CVEOyi26.js";const ze=z({__name:"ReportBugDialog",setup(C){const e=useForm({location:null,summary:null,description:null,attachments:[]});return(u,r)=>(d(),m(X,{"max-width":"1000"},{activator:o(({props:i})=>[p("div",re(se(i)),[t(h,{icon:"mdi-bug",color:"primary",class:"me-2"}),r[4]||(r[4]=b(" Fehler melden ",-1))],16)]),default:o(({isActive:i})=>[t(_,{title:"Fehler melden"},{append:o(()=>[t(f,{icon:"",variant:"text",onClick:a=>{i.value=!1,s(e).reset()}},{default:o(()=>[t(h,null,{default:o(()=>[...r[5]||(r[5]=[b("mdi-close",-1)])]),_:1})]),_:1},8,["onClick"])]),default:o(()=>[t(K),t(ee,null,{default:o(()=>[t(te,{onSubmit:c(a=>{s(e).post(u.route("reportBug.store"),{onSuccess:()=>{i.value=!1,s(e).reset()}})},["prevent"])},{default:o(()=>[t(oe,null,{default:o(()=>[t(I,{cols:"12"},{default:o(()=>[t(U,{modelValue:s(e).location,"onUpdate:modelValue":r[0]||(r[0]=a=>s(e).location=a),errorMessages:s(e).errors.location,label:"Wo ist der Fehler aufgetreten?"},null,8,["modelValue","errorMessages"])]),_:1}),t(I,{cols:"12"},{default:o(()=>[t(U,{modelValue:s(e).summary,"onUpdate:modelValue":r[1]||(r[1]=a=>s(e).summary=a),errorMessages:s(e).errors.summary,label:"Fasse den Fehler zusammen"},null,8,["modelValue","errorMessages"])]),_:1}),t(I,{cols:"12"},{default:o(()=>[t(ae,{"max-rows":"16","auto-grow":"",modelValue:s(e).description,"onUpdate:modelValue":r[2]||(r[2]=a=>s(e).description=a),errorMessages:s(e).errors.description,label:"Zusätzliche Informationen zum Fehler"},null,8,["modelValue","errorMessages"])]),_:1}),t(I,{cols:"12"},{default:o(()=>[t(ne,{modelValue:s(e).attachments,"onUpdate:modelValue":r[3]||(r[3]=a=>s(e).attachments=a),errorMessages:Object.entries(s(e).errors).filter(([a,v])=>a.includes("attachments")&&v).map(([a])=>"Alle Dateien müssen ein Bild sein."),label:"Anhang",multiple:"",accept:"image/*"},null,8,["modelValue","errorMessages"])]),_:1}),t(I,{cols:"12",class:"text-end"},{default:o(()=>[t(f,{type:"submit",color:"primary"},{default:o(()=>[...r[6]||(r[6]=[b("Absenden",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:2},1024)]),_:2},1024)]),_:1}))}}),Se=z({__name:"AppbarActions",setup(C){const e=W(),u=Z(),r=$(u.props.unreadNotifications.length);return ie("notification."+u.props.auth.user.id,"NotificationCreated",i=>{r.value=i.unreadCount}),(i,a)=>(d(),D(de,null,[t(f,{color:"primary",stacked:"",onClick:a[0]||(a[0]=c(v=>s(g).get(i.route("notification.index")),["stop"]))},{default:o(()=>[r.value>0?(d(),m(le,{key:0,content:r.value<=99?r.value:"99+",color:"error"},{default:o(()=>[t(h,{icon:"mdi-bell"})]),_:1},8,["content"])):(d(),m(h,{key:1,icon:"mdi-bell"}))]),_:1}),t(pe,{location:s(e).smAndDown.value?"bottom left":"bottom"},{activator:o(({props:v})=>[t(f,ue({stacked:"",color:"primary","prepend-icon":"mdi-account-details"},v),null,16)]),default:o(()=>[t(T,{"min-width":"200px"},{default:o(()=>[t(M,{onClick:a[1]||(a[1]=c(v=>s(g).get(i.route("user.profile",{user:i.$page.props.auth.user.id})),["stop"]))},{default:o(()=>[t(h,{icon:"mdi-account",color:"primary",class:"me-2"}),a[3]||(a[3]=b(" Profil ",-1))]),_:1}),t(M,{onClick:c(()=>{},["stop"])},{default:o(()=>[t(ze)]),_:1}),t(M,{onClick:a[2]||(a[2]=c(v=>s(g).post(i.route("logout")),["stop"]))},{default:o(()=>[t(h,{icon:"mdi-logout",color:"primary",class:"me-2"}),a[4]||(a[4]=b(" Abmelden ",-1))]),_:1})]),_:1})]),_:1},8,["location"])],64))}}),Le=x(Se,[["__scopeId","data-v-3ce3236f"]]),De=z({__name:"DrawerMenu",setup(C){return(e,u)=>(d(),m(T,{nav:"","onClick:select":u[0]||(u[0]=r=>s(g).get(r.id)),items:[{props:{active:e.route().current("dashboard"),prependIcon:"mdi-view-dashboard"},value:e.route("dashboard"),title:"Dashboard"},...e.$page.props.currentAppModule=="tide"?[e.can("workLog","viewIndex")&&{props:{active:e.route().current("workLog.index"),prependIcon:"mdi-clock-outline"},value:e.route("workLog.index"),title:"Arbeitszeiten"}]:[],...e.$page.props.currentAppModule=="flow"?[e.can("customer","viewIndex")&&{props:{active:e.route().current("customer.index"),prependIcon:"mdi-folder-account-outline"},value:e.route("customer.index"),title:"Kundenliste"},{props:{active:e.route().current("ticket.index"),prependIcon:"mdi-ticket-account"},value:e.route("ticket.index"),title:"Tickets"}]:[],e.can("dispute","viewIndex")&&{props:{active:e.route().current("dispute.index"),prependIcon:"mdi-bookmark-outline"},value:e.route("dispute.index"),title:"Anträge"},e.can("absence","viewIndex")&&{props:{active:e.route().current("absence.index"),prependIcon:"mdi-timer-cancel-outline"},value:e.route("absence.index"),title:"Abwesenheiten"},e.can("organization","viewShow")&&{title:"Organisation",value:e.route("organization.show",{organization:e.$page.props.organization.id}),props:{prependIcon:"mdi-domain",active:e.route().current("organization.show")}},e.can("operatingSite","viewIndex")&&{props:{active:e.route().current("operatingSite.index"),prependIcon:"mdi-map-marker"},value:e.route("operatingSite.index"),title:"Betriebsstätten"},e.can("group","viewIndex")&&{props:{active:e.route().current("group.index"),prependIcon:"mdi-dots-circle"},value:e.route("group.index"),title:"Abteilungen"},e.can("user","viewIndex")&&{props:{active:e.route().current("user.index"),prependIcon:"mdi-account-group"},value:e.route("user.index"),title:"Mitarbeitende"},e.can("user","viewIndex")&&{props:{prependIcon:"mdi-tree",active:e.route().current("organization.tree")},value:e.route("organization.tree",{organization:e.$page.props.organization.id}),title:"Organigramm"},e.can("chatAssistant","viewIndex")&&e.$page.props.organization.isa_active&&{props:{prependIcon:"mdi-chat-question-outline",active:e.route().current("isa.index")},value:e.route("isa.index"),title:"ISA"},...e.can("organization","viewIndex")?[{type:"divider"},{type:"subheader",title:"Super-Admin"},{props:{prependIcon:"mdi-security",active:e.route().current("organization.index")},value:e.route("organization.index"),title:"Organisationen"}]:[]].filter(Boolean)},null,8,["items"]))}}),Te=x(De,[["__scopeId","data-v-e1f699b5"]]),xe={key:0,class:"posiion-relative",style:{width:"56px"}},Be={class:"d-flex align-center"},Fe={class:"text-center text-h5 font-weight-medium"},Ne={style:{"user-select":"none"}},Ue={class:"d-flex align-center mr-auto ga-2"},Pe={class:"text-h6 ps-0 mx-5 px-2 mb-0",style:{"text-overflow":"ellipsis",overflow:"hidden","white-space":"nowrap","max-width":"calc(100vw - 72px - 72px - 52px)"}},Oe={key:0},Ee={class:"chat-space bg-white elevation-12"},Re={class:"chat-header"},je={class:"d-flex align-center gap-2 chat-button"},qe={style:{width:"fit-content"}},Ge={class:"chat-body"},He=z({__name:"AdminLayout",props:{title:{},backurl:{},noInlinePadding:{type:Boolean}},setup(C){const e=C,u=Z(),r=W().smAndDown,i=$(!r.value),{start:a,stop:v}=ce(1e3*60*2,{only:["unreadNotifications"]},{keepAlive:!0});me(()=>{a()}),g.on("before",()=>{v()}),g.on("finish",()=>{a()});const S=$(!!u.props.organization.logo);P(()=>u.props.organization.logo,()=>{S.value=!1,ge(()=>S.value=!0)});function Y(n){g.post(route("switchAppModule",{module:n}),{preserveState:!0,preserveScroll:!0,replace:!0})}const V=ve(()=>u.props.appModules.find(n=>n.value===u.props.currentAppModule)),y=$(!1),B={id:-999,role:"assistant",created_at:fe.local().toISO(),msg:"Hallo, ich bin ISA. Wie kann ich Ihnen helfen?"},F={id:-999,chat_messages:[B]};P(()=>!!u.props.currentUserChat,()=>{F.chat_messages=[B]});function J(){y.value=!0}function N(){y.value=!1}function Q(){var n;g.delete(route("isa.deleteChat",{chat:(n=u.props.currentUserChat)==null?void 0:n.id}),{preserveState:!0,preserveScroll:!0}),y.value=!0}return(n,l)=>(d(),m(he,null,{default:o(()=>[t(s(be),{title:n.title},null,8,["title"]),t(we,{color:"background",style:{border:"none"},modelValue:i.value,"onUpdate:modelValue":l[2]||(l[2]=w=>i.value=w),image:"/img/loggedin-background.png"},{default:o(()=>[V.value?(d(),m(T,{key:0},{default:o(()=>[t(M,{onClick:l[1]||(l[1]=c(w=>Y(n.$page.props.currentAppModule=="tide"?"flow":"tide"),["stop"])),class:"pe-2"},{prepend:o(()=>[s(u).props.appModules.length==2?(d(),D("div",xe,[p("img",{src:"/img/Tide-Logo.webp",id:"tide-logo",class:L({ActiveLogo:V.value.value=="tide"})},null,2),t(h,{icon:"mdi-undo",style:{top:"0",position:"absolute",rotate:"-20deg",scale:"0.8"}}),p("img",{src:"/img/Flow-Logo.webp",id:"flow-logo",class:L({ActiveLogo:V.value.value=="flow"})},null,2),t(h,{icon:"mdi-undo",style:{top:"25px",left:"40px",position:"absolute",rotate:"140deg",scale:"0.8"}})])):(d(),m(O,{key:1,width:"24px",class:"me-8",src:"/img/logo-symbol.png"}))]),append:o(()=>[t(f,{onClick:l[0]||(l[0]=c(w=>i.value=!1,["stop"])),icon:"mdi-close",variant:"text"})]),default:o(()=>[t(ke,null,{default:o(()=>[p("div",Be,[p("h1",Fe,[p("span",Ne,A(V.value.title),1)])])]),_:1})]),_:1})]),_:1})):k("",!0),t(K),t(Te)]),_:1},8,["modelValue"]),t(ye,{elevation:"0",color:"background"},{default:o(()=>[!i.value||s(r)?(d(),m(R,{key:0,variant:"text",onClick:l[3]||(l[3]=c(w=>i.value=!i.value,["stop"]))})):k("",!0),n.backurl?(d(),m(R,{key:1,variant:"text",icon:"mdi-arrow-left",onClick:l[4]||(l[4]=c(w=>s(g).visit(n.backurl,{preserveState:!0}),["stop"]))})):k("",!0),p("div",Ue,[p("span",Pe,A(n.title),1),S.value?(d(),m(O,{key:0,src:n.route("organization.getLogo",{organization:n.$page.props.organization.id,key:n.$page.props.organization.logo}),"max-height":"48px","max-width":"48px",width:"100%",height:"100%",class:"rounded"},null,8,["src"])):k("",!0)]),E(n.$slots,"appbarActions",{},void 0,!0),t(Le)]),_:3}),t(Ie,null,{default:o(()=>[t(Ce,{class:L(["pt-0",e.noInlinePadding?"px-0":""]),style:Ve(n.$page.props.organization.isa_active?"padding-bottom: calc(60px + 16px + 4px)":""),fluid:""},{default:o(()=>[n.$page.props.flash.error?(d(),m(j,{type:"error",closable:"",class:"mb-6",key:Math.random(),"onClick:close":l[5]||(l[5]=w=>H.value=!1)},{default:o(()=>[b(A(n.$page.props.flash.error),1)]),_:1})):k("",!0),n.$page.props.flash.success?(d(),m(j,{type:"success",closable:"",class:"mb-6",key:Math.random(),"onClick:close":l[6]||(l[6]=w=>H.value=!1)},{default:o(()=>[b(A(n.$page.props.flash.success),1)]),_:1})):k("",!0),E(n.$slots,"default",{},void 0,!0)]),_:3},8,["style","class"]),n.$page.props.organization.isa_active?(d(),D("div",Oe,[q(t(f,{class:"chat-button",style:{position:"fixed",bottom:"20px",right:"20px"},type:"button",title:"Chat öffnen",onClick:c(J,["stop"])},{default:o(()=>[...l[7]||(l[7]=[p("img",{src:"/img/Isa-klein.png",alt:""},null,-1)])]),_:1},512),[[G,!y.value]]),t(Ae,{name:"chat-pop"},{default:o(()=>[q(p("div",Ee,[p("div",Re,[p("div",je,[p("img",{src:"/img/Isa-klein.png",role:"button",onClick:c(N,["stop"]),alt:"ISA Logo"}),t($e,{class:"text-h6"},{default:o(()=>[...l[8]||(l[8]=[b("ISA",-1)])]),_:1})]),p("div",qe,[t(f,{icon:"mdi-window-minimize",color:"primary",variant:"text",onClick:c(N,["stop"]),title:"Chat minimieren"}),t(f,{icon:"mdi-chat-plus",color:"primary",variant:"text",onClick:c(Q,["stop"]),title:"Neuer Chat"})])]),p("div",Ge,[t(Me,{showChat:y.value,chat:n.$page.props.currentUserChat?n.$page.props.currentUserChat:F,reachedMonthlyTokenLimit:n.$page.props.reachedMonthlyTokenLimit},null,8,["showChat","chat","reachedMonthlyTokenLimit"])])],512),[[G,y.value]])]),_:1})])):k("",!0)]),_:3})]),_:3}))}}),Je=x(He,[["__scopeId","data-v-c9bc53b8"]]);export{Je as A};

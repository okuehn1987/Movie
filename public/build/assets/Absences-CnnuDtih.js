import{A as M}from"./AdminLayout-DihteqcX.js";import{d as w,r as v,a as _,o as m,b as a,f as s,V as A,g as o,h as Q,K as S,e as k,L as b,T as B,s as c,aF as L,j as y,F as h,z as D,aG as N,aH as F,t as l,aI as C,D as d,i as u,y as E,aB as T,az as U}from"./app-Dyt73HYk.js";import{_ as G}from"./UserShowNavBar.vue_vue_type_script_setup_true_lang-D8cj21Og.js";import{u as x}from"./utils-ZHyS8-Az.js";import"./ChatDetails-pFCxyMpm.js";import"./ChatMessage-eVixLBPX.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"text-h6"},P={class:"font-weight-bold"},Y={colspan:"4"},J={class:"font-weight-bold"},j={colspan:"4"},H={class:"font-weight-bold"},K={colspan:"4"},ee=w({__name:"Absences",props:{user:{},usedLeaveDaysForYear:{},absenceTypes:{}},setup(O){const V=v([]),g=v([]);return(n,f)=>(m(),_(M,{title:n.user.first_name+" "+n.user.last_name},{default:a(()=>[s(G,{user:n.user,tab:"absences"},null,8,["user"]),s(A,{"max-height":o(x)(48).value,class:"overflow-auto"},{default:a(()=>[s(Q,null,{default:a(()=>[s(S,null,{default:a(()=>[n.user.absences.length===0?(m(),_(b,{key:0},{default:a(()=>[s(B,{color:"info"},{default:a(()=>[...f[2]||(f[2]=[c("Keine Abwesenheiten vorhanden.",-1)])]),_:1})]),_:1})):k("",!0),s(b,null,{default:a(()=>[s(L,{elevation:"1",multiple:"",modelValue:g.value,"onUpdate:modelValue":f[1]||(f[1]=t=>g.value=t)},{default:a(()=>[(m(!0),y(h,null,D(Object.entries(n.usedLeaveDaysForYear).toSorted(([t,p],[r,e])=>r.localeCompare(t)),([t,p])=>(m(),_(N,{key:t,value:t},{default:a(()=>[s(F,null,{default:a(()=>[c(l(t),1)]),_:2},1024),s(C,null,{default:a(()=>[s(L,{elevation:"1",multiple:"",modelValue:V.value,"onUpdate:modelValue":f[0]||(f[0]=r=>V.value=r)},{default:a(()=>[(m(!0),y(h,null,D(n.absenceTypes,r=>(m(),y(h,{key:t+"/"+r.id},[n.user.absences.filter(e=>e.absence_type_id==r.id&&o(d).fromSQL(e.start).year<=Number(t)&&o(d).fromSQL(e.end).year>=Number(t)).reduce((e,i)=>e+(i.usedDays[t]??0),0)>0?(m(),_(N,{key:0,value:t+"/"+r.id},{default:a(()=>[s(F,null,{default:a(()=>[s(S,null,{default:a(()=>[s(b,{cols:"12",md:"11"},{default:a(()=>[u("h2",z,l(r.name),1)]),_:2},1024),s(b,{cols:"12",md:"1",style:{"place-self":"center"}},{default:a(()=>[c(l(n.user.absences.filter(e=>e.absence_type_id==r.id&&o(d).fromSQL(e.start).year<=Number(t)&&o(d).fromSQL(e.end).year>=Number(t)).reduce((e,i)=>e+(i.usedDays[t]??0),0))+" Tage ",1)]),_:2},1024)]),_:2},1024)]),_:2},1024),s(C,null,{default:a(()=>[s(E,{id:"userAbsenceTable",items:n.user.absences.filter(e=>e.absence_type_id==r.id&&o(d).fromSQL(e.start).year<=Number(t)&&o(d).fromSQL(e.end).year>=Number(t)).toSorted((e,i)=>i.start.localeCompare(e.start)).map(e=>{var i;return{...e,start:o(d).fromSQL(e.start).toFormat("dd.MM.yyyy"),end:o(d).fromSQL(e.end).toFormat("dd.MM.yyyy"),absence_type:(i=e.absence_type)==null?void 0:i.name,usedDays:e.usedDays[t]}}),headers:[{title:"Start",key:"start"},{title:"Ende",key:"end"},{title:"Status",key:"status"},{title:"Art",key:"absence_type"},{title:"Genutzte Tage",key:"usedDays"}]},T({"item.status":a(({item:e})=>[s(U,{color:{accepted:"success",created:"warning",declined:"error"}[e.status]},{default:a(()=>[c(l({accepted:"Genehmigt",created:"Offen",declined:"Abgelehnt"}[e.status]),1)]),_:2},1032,["color"])]),"item.start":a(({item:e})=>[c(l(o(d).fromFormat(e.start,"dd.MM.yyyy").year!=Number(t)?"01.01."+t:e.start),1)]),"item.end":a(({item:e})=>[c(l(o(d).fromFormat(e.end,"dd.MM.yyyy").year!=Number(t)?"31.12."+t:e.end),1)]),_:2},[r.name=="Urlaub"?{name:"body.append",fn:a(()=>[u("tr",P,[u("td",Y," Genehmigte Urlaubstage für das Jahr "+l(t)+": ",1),u("td",null,l(p.accepted),1)]),u("tr",J,[u("td",j," Beantragte Urlaubstage für das Jahr "+l(t)+": ",1),u("td",null,l(p.created),1)]),u("tr",H,[u("td",K," Gesamt genutzte Urlaubstage für das Jahr "+l(t)+": ",1),u("td",null,l(p.accepted+p.created+" von "+n.user.leaveDaysForYear),1)])]),key:"0"}:void 0]),1032,["items"])]),_:2},1024)]),_:2},1032,["value"])):k("",!0)],64))),128))]),_:2},1032,["modelValue"])]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["max-height"])]),_:1},8,["title"]))}});export{ee as default};

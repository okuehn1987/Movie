import{d as R,as as v,ar as $,r as q,a as d,o as u,b as a,e as A,f as s,V as k,aC as F,s as n,h as C,J as w,m as _,g as i,K as m,ao as c,L as r,v as I,O as M,l as f,p as h,i as E,M as D,y as L,D as P,aB as H,q as O,A as J}from"./app-BqC0o-bR.js";import{A as j}from"./AdminLayout-BpRSJLGD.js";import{_ as G}from"./PaymentTable.vue_vue_type_script_setup_true_lang-CdBBLkHa.js";import"./ChatDetails-D5dAZShP.js";import"./ChatMessage-Dis7vRrh.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./utils-SP1thiZ6.js";const et=R({__name:"IsaIndex",props:{chatAssistant:{},files:{},stats:{}},setup(S){const p=S,o=v({chatFile_ids:p.chatAssistant.chat_files.map(t=>t.id),monthly_cost_limit:p.chatAssistant.monthly_cost_limit}),{files:z}=$(p),V=v({files:[]}),T=p.chatAssistant.id,y=q(null);function B(){var t;(t=y.value)==null||t.click()}function K(t){V.files=t,V.post(route("file.store"),{onSuccess:()=>{V.reset()},onFinish:()=>{y.value&&(y.value.value="")}})}function N(t){J.delete(route("file.destroy",t.id),{})}function b(t,e){const l=t/e*100;return l>=90?"error":l>=70?"warning":"success"}return(t,e)=>(u(),d(j,{title:"Einstellungen für ISA",tooltip:"TooltipChatAssistantIndex"},{default:a(()=>[t.can("chatAssistant","showPaymentInfo")?(u(),d(k,{key:0,class:"mb-4"},{default:a(()=>[s(F,{class:"my-4"},{default:a(()=>[...e[9]||(e[9]=[n("Kostenverwaltung",-1)])]),_:1}),s(C,null,{default:a(()=>[t.can("chatAssistant","update")?(u(),d(w,{key:0,onSubmit:e[2]||(e[2]=_(l=>i(o).patch(t.route("isa.update",{isa:t.chatAssistant.id})),["prevent"]))},{default:a(()=>[s(m,null,{default:a(()=>[s(c,{class:"mt-4"},{default:a(()=>[...e[10]||(e[10]=[n("Aktuelle Verbrauchsanzeige",-1)])]),_:1}),s(r,{class:"pt-2 mb-4",cols:"12"},{default:a(()=>[s(I,{title:" "+Math.floor(t.chatAssistant.current_monthly_cost/t.chatAssistant.monthly_cost_limit*100)+"% des monatlichen Kostenlimits sind erreicht",rounded:"",max:t.chatAssistant.monthly_cost_limit,modelValue:t.chatAssistant.current_monthly_cost,"onUpdate:modelValue":e[0]||(e[0]=l=>t.chatAssistant.current_monthly_cost=l),color:b(t.chatAssistant.current_monthly_cost,t.chatAssistant.monthly_cost_limit),height:"15"},null,8,["title","max","modelValue","color"])]),_:1}),s(r,{cols:"11"},{default:a(()=>[s(M,{modelValue:i(o).monthly_cost_limit,"onUpdate:modelValue":e[1]||(e[1]=l=>i(o).monthly_cost_limit=l),label:"Monatliches Kostenlimit in €",required:"",errorMessages:i(o).errors.monthly_cost_limit,variant:"outlined",density:"compact"},null,8,["modelValue","errorMessages"])]),_:1}),s(r,{cols:"1",class:"text-end"},{default:a(()=>[s(f,{color:"primary",type:"submit",disabled:i(o).processing,loading:i(o).processing},{default:a(()=>[s(h,{size:"large"},{default:a(()=>[...e[11]||(e[11]=[n("mdi-content-save",-1)])]),_:1})]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1})):(u(),d(m,{key:1},{default:a(()=>[s(c,{class:"mt-4"},{default:a(()=>[...e[12]||(e[12]=[n("Aktuelle Verbrauchsanzeige",-1)])]),_:1}),s(r,{class:"pt-2 mb-4",cols:"12"},{default:a(()=>[s(I,{title:" "+Math.floor(t.chatAssistant.current_monthly_cost/t.chatAssistant.monthly_cost_limit*100)+"% des monatlichen Kostenlimits sind erreicht",rounded:"",max:t.chatAssistant.monthly_cost_limit,modelValue:t.chatAssistant.current_monthly_cost,"onUpdate:modelValue":e[3]||(e[3]=l=>t.chatAssistant.current_monthly_cost=l),color:b(t.chatAssistant.current_monthly_cost,t.chatAssistant.monthly_cost_limit),height:"15"},null,8,["title","max","modelValue","color"])]),_:1}),s(r,{cols:"12"},{default:a(()=>[s(M,{modelValue:i(o).monthly_cost_limit,"onUpdate:modelValue":e[4]||(e[4]=l=>i(o).monthly_cost_limit=l),label:"Monatliches Kostenlimit in €",required:"",errorMessages:i(o).errors.monthly_cost_limit,"hide-details":"",variant:"outlined",density:"compact"},null,8,["modelValue","errorMessages"])]),_:1})]),_:1})),s(m,null,{default:a(()=>[s(c,{class:"mt-8"},{default:a(()=>[...e[13]||(e[13]=[n("Verbrauchsübersicht",-1)])]),_:1}),s(r,{cols:"12"},{default:a(()=>[s(G,{stats:t.stats,chatAssistantId:i(T)},null,8,["stats","chatAssistantId"])]),_:1})]),_:1})]),_:1})]),_:1})):A("",!0),s(k,{class:"mb-4"},{default:a(()=>[s(F,{class:"my-4"},{default:a(()=>[...e[14]||(e[14]=[n("Dateiverwaltung",-1)])]),_:1}),s(c,{class:"mt-4"},{default:a(()=>[...e[15]||(e[15]=[n("Verwendete Dateien",-1)])]),_:1}),s(C,{class:"pt-0"},{default:a(()=>[t.can("chatAssistant","update")?(u(),d(w,{key:0,onSubmit:e[6]||(e[6]=_(l=>i(o).patch(t.route("isa.update",{isa:t.chatAssistant.id})),["prevent"]))},{default:a(()=>[s(m,null,{default:a(()=>[s(r,{cols:"11"},{default:a(()=>[s(D,{color:"primary",items:t.files.map(l=>({title:l.name,value:l.id})),modelValue:i(o).chatFile_ids,"onUpdate:modelValue":e[5]||(e[5]=l=>i(o).chatFile_ids=l),multiple:"",chips:"","no-data-text":"Es wurden keine Dateien hochgeladen",errorMessages:i(o).errors.chatFile_ids,"hide-details":"",density:"comfortable"},null,8,["items","modelValue","errorMessages"])]),_:1}),s(r,{cols:"1",class:"text-end"},{default:a(()=>[s(f,{color:"primary",type:"submit",disabled:i(o).processing,loading:i(o).processing},{default:a(()=>[s(h,{size:"large"},{default:a(()=>[...e[16]||(e[16]=[n("mdi-content-save",-1)])]),_:1})]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1})):(u(),d(m,{key:1},{default:a(()=>[s(r,{cols:"12"},{default:a(()=>[s(D,{color:"primary",items:t.files.map(l=>({title:l.name,value:l.id})),modelValue:i(o).chatFile_ids,"onUpdate:modelValue":e[7]||(e[7]=l=>i(o).chatFile_ids=l),multiple:"",chips:"","hide-details":"",density:"comfortable"},null,8,["items","modelValue"])]),_:1})]),_:1}))]),_:1}),s(c,{class:"mt-6"},{default:a(()=>[...e[17]||(e[17]=[n("Dateiübersicht",-1)])]),_:1}),E("input",{hidden:"",ref_key:"fileInputRef",ref:y,type:"file",accept:"application/pdf",multiple:"",onChange:e[8]||(e[8]=l=>K(l.target.files))},null,544),s(L,{"fixed-header":"","no-data-text":"Es wurden noch keine Dateien Hochgeladen",class:"mx-auto",headers:[{title:"Dateiname",value:"name"},{title:"Hinzugefügt",value:"created_at"},{title:"Status",value:"is_used_text"},{title:"",value:"actions",align:"end"}],items:i(z).map(l=>{const g=!!t.chatAssistant.chat_files.find(U=>U.id==l.id);return{...l,created_at:i(P).fromISO(l.created_at).toFormat("dd.MM.yyyy hh:mm"),is_used:g,is_used_text:g?"In Benutzung":"Nicht verwendet"}})},H({"item.actions":a(({item:l})=>[t.can("chatAssistant","showChatFiles")?(u(),d(f,{key:0,href:t.route("file.show",{file:l.id.toString()})},{default:a(()=>[s(h,{icon:"mdi-eye",color:"primary"})]),_:1},8,["href"])):A("",!0),t.can("chatAssistant","editChatFiles")?(u(),d(f,{key:1,disabled:l.is_used,onClick:_(g=>N(l),["stop"]),class:"ms-2",color:"error",style:O([{"pointer-events":"auto"},{cursor:l.is_used?"default":"pointer"}]),title:l.is_used?"Verwendete Dateien können nicht gelöscht werden":"Datei entfernen"},{default:a(()=>[s(h,{icon:"mdi-delete"})]),_:1},8,["disabled","onClick","style","title"])):A("",!0)]),_:2},[t.can("chatAssistant","editChatFiles")?{name:"header.actions",fn:a(()=>[s(f,{title:"Neue Datei hochladen",color:"primary",onClick:_(B,["stop"])},{default:a(()=>[s(h,{icon:"mdi-plus"})]),_:1})]),key:"0"}:void 0]),1032,["items"])]),_:1})]),_:1}))}});export{et as default};

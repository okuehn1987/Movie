import{d as E,B as j,u as S,C as U,w as k,r as O,a as w,o as z,b as t,f as s,V as q,x as G,g as I,e as H,i as m,E as K,G as D,H as L,I as x,J as T,K as V,L as d,M as f,N as M,h as P,l as n,m as v,s as o,O as R,y as W,p as F,t as N,P as Z,Q as J}from"./app-B0tzRfiS.js";const Q={class:"d-flex justify-end"},X=E({__name:"AbsenceFilter",props:j({user_absence_filters:{},users:{},absence_types:{},schoolHolidays:{},federal_state:{},all_federal_states:{}},{filterForm:{required:!0},filterFormModifiers:{},singleFilterForm:{required:!0},singleFilterFormModifiers:{}}),emits:["update:filterForm","update:singleFilterForm"],setup(_){const b=_,p={set:null,selected_users:[],selected_absence_types:[],selected_statuses:["created","accepted"],selected_holidays:[b.federal_state]},A=S(),a=U(_,"filterForm"),u=U(_,"singleFilterForm"),g=useForm({filter_id:null});k(()=>a.value.set,C);function C(r){if(r==null)return;let e;if(typeof r=="object"&&a.value.isDirty?e=b.user_absence_filters.find(l=>l.id==r.value):typeof r=="string"&&(e=b.user_absence_filters.find(l=>l.name==r)),!e)return;const i={set:typeof r=="string"?{title:r,value:e.id}:r,selected_users:e.data.user_ids,selected_absence_types:e.data.absence_type_ids,selected_statuses:e.data.statuses,selected_holidays:e.data.holidays_from_federal_states};a.value.defaults(i).reset()}k(()=>u.value.set,r=>{if(r==null)return;const e=b.user_absence_filters.find(i=>i.id==r);e&&(u.value.defaults({set:e.id,selected_users:e.data.user_ids,selected_absence_types:e.data.absence_type_ids,selected_statuses:e.data.statuses,selected_holidays:e.data.holidays_from_federal_states}),u.value.reset())});function $(){var r;typeof a.value.set!="string"&&((r=a.value.set)!=null&&r.value)?a.value.patch(route("userAbsenceFilter.update",{userAbsenceFilter:a.value.set.value})):a.value.post(route("userAbsenceFilter.store"),{onSuccess:()=>{C(a.value.set)}})}function B(r){const e={value:r.id,title:r.name};a.value.defaults({set:e,selected_users:r.data.user_ids??[],selected_absence_types:r.data.absence_type_ids??[],selected_statuses:r.data.statuses??[],selected_holidays:r.data.holidays_from_federal_states??[]}),a.value.set=e,a.value.reset()}const y=O("singleFilter");return k([()=>u.value.set,()=>a.value.set],([r,e],[i,l])=>{i==null&&r!=null?a.value.defaults(p).reset():l==null&&e!=null&&u.value.defaults(p).reset()}),(r,e)=>(z(),w(J,{"max-width":"1000"},{activator:t(({props:i})=>[s(n,Z(i,{variant:"flat",color:"primary"}),{default:t(()=>[s(F,null,{default:t(()=>[...e[15]||(e[15]=[o("mdi-filter",-1)])]),_:1})]),_:1},16)]),default:t(({isActive:i})=>[s(q,{title:"Abwesenheiten filtern"},{append:t(()=>[s(n,{icon:"",variant:"text",onClick:l=>{i.value=!1,_.filterForm.reset()}},{default:t(()=>[s(F,null,{default:t(()=>[...e[16]||(e[16]=[o("mdi-close",-1)])]),_:1})]),_:1},8,["onClick"])]),default:t(()=>[s(G),s(I,null,{default:t(()=>[m(A).smAndDown.value?H("",!0):(z(),w(K,{key:0,modelValue:y.value,"onUpdate:modelValue":e[0]||(e[0]=l=>y.value=l),color:"primary"},{default:t(()=>[s(D,{text:"Einzelfilter",value:"singleFilter"}),s(D,{text:"Filtergruppen",value:"groupFilter"})]),_:1},8,["modelValue"])),s(L,{modelValue:y.value,"onUpdate:modelValue":e[14]||(e[14]=l=>y.value=l),class:"w-100"},{default:t(()=>[s(x,{value:"singleFilter"},{default:t(()=>[s(T,null,{default:t(()=>[s(V,{class:"mt-2"},{default:t(()=>[s(d,{cols:"12"},{default:t(()=>[s(f,{label:"Filtergruppe ausw채hlen","auto-select-first":"exact",variant:"underlined",items:r.user_absence_filters.map(l=>({value:l.id,title:l.name})),modelValue:u.value.set,"onUpdate:modelValue":e[1]||(e[1]=l=>u.value.set=l),"error-messages":u.value.errors.set,"item-title":"title","item-value":"value",required:"",clearable:""},null,8,["items","modelValue","error-messages"])]),_:1}),s(d,{cols:"12"},{default:t(()=>[s(M,{label:"Nutzer",items:r.users.map(l=>({title:l.first_name+" "+l.last_name,value:l.id})),modelValue:u.value.selected_users,"onUpdate:modelValue":e[2]||(e[2]=l=>u.value.selected_users=l),"error-messages":u.value.errors.selected_users,clearable:"",chips:"",multiple:"",variant:"underlined",autocomplete:"off"},null,8,["items","modelValue","error-messages"])]),_:1}),s(d,{cols:"12"},{default:t(()=>[s(f,{label:"Abwesenheitsgrund",items:r.absence_types.map(l=>({title:l.name,value:l.id})),modelValue:u.value.selected_absence_types,"onUpdate:modelValue":e[3]||(e[3]=l=>u.value.selected_absence_types=l),"error-messages":u.value.errors.selected_absence_types,clearable:"",chips:"",multiple:""},null,8,["items","modelValue","error-messages"])]),_:1}),s(d,{cols:"12"},{default:t(()=>[s(f,{label:"Abwesenheitsstatus",items:[{title:"Erstellt",value:"created"},{title:"Akzeptiert",value:"accepted"},{title:"Abgelehnt",value:"declined"}],modelValue:u.value.selected_statuses,"onUpdate:modelValue":e[4]||(e[4]=l=>u.value.selected_statuses=l),"error-messages":u.value.errors.selected_statuses,clearable:"",chips:"",multiple:""},null,8,["modelValue","error-messages"])]),_:1}),s(d,{cols:"12"},{default:t(()=>[s(f,{label:"Ferien",clearable:"",chips:"",multiple:"",modelValue:u.value.selected_holidays,"onUpdate:modelValue":e[5]||(e[5]=l=>u.value.selected_holidays=l),"error-messages":u.value.errors.selected_holidays,items:Object.entries(r.all_federal_states).map(([l,c])=>({value:l,title:c}))},null,8,["modelValue","error-messages","items"])]),_:1}),s(d,{cols:"12"},{default:t(()=>[P("div",Q,[s(n,{class:"me-2",color:"primary",variant:"flat",onClick:e[6]||(e[6]=v(l=>u.value.defaults(p).reset(),["stop"]))},{default:t(()=>[...e[17]||(e[17]=[o(" Zur체cksetzen ",-1)])]),_:1}),s(n,{color:"primary",variant:"flat",onClick:v(l=>i.value=!1,["stop"])},{default:t(()=>[...e[18]||(e[18]=[o("Anwenden",-1)])]),_:1},8,["onClick"])])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),s(x,{value:"groupFilter"},{default:t(()=>[s(T,{onSubmit:e[13]||(e[13]=v(l=>$(),["prevent"]))},{default:t(()=>[s(V,{class:"mt-2"},{default:t(()=>[s(d,{cols:"12",md:"6"},{default:t(()=>[s(V,null,{default:t(()=>[s(d,{cols:"12"},{default:t(()=>[s(R,{label:"Gruppename","model-value":typeof a.value.set=="object"&&a.value.set!==null?a.value.set.title:a.value.set??"","onUpdate:modelValue":e[7]||(e[7]=l=>{a.value.set=l}),"error-messages":a.value.errors.set},null,8,["model-value","error-messages"])]),_:1}),s(d,{cols:"12"},{default:t(()=>[s(M,{label:"Nutzer",items:r.users.map(l=>({title:l.first_name+" "+l.last_name,value:l.id})),modelValue:a.value.selected_users,"onUpdate:modelValue":e[8]||(e[8]=l=>a.value.selected_users=l),"error-messages":a.value.errors.selected_users,clearable:"",chips:"",multiple:"",variant:"underlined",autocomplete:"off"},null,8,["items","modelValue","error-messages"])]),_:1}),s(d,{cols:"12"},{default:t(()=>[s(f,{label:"Abwesenheitsgrund",items:r.absence_types.map(l=>({title:l.name,value:l.id})),modelValue:a.value.selected_absence_types,"onUpdate:modelValue":e[9]||(e[9]=l=>a.value.selected_absence_types=l),"error-messages":a.value.errors.selected_absence_types,clearable:"",chips:"",multiple:""},null,8,["items","modelValue","error-messages"])]),_:1}),s(d,{cols:"12"},{default:t(()=>[s(f,{label:"Abwesenheitsstatus",items:[{title:"Erstellt",value:"created"},{title:"Akzeptiert",value:"accepted"},{title:"Abgelehnt",value:"declined"}],modelValue:a.value.selected_statuses,"onUpdate:modelValue":e[10]||(e[10]=l=>a.value.selected_statuses=l),"error-messages":a.value.errors.selected_statuses,clearable:"",chips:"",multiple:""},null,8,["modelValue","error-messages"])]),_:1}),s(d,{cols:"12"},{default:t(()=>[s(f,{label:"Ferien",clearable:"",chips:"",multiple:"",modelValue:a.value.selected_holidays,"onUpdate:modelValue":e[11]||(e[11]=l=>a.value.selected_holidays=l),"error-messages":a.value.errors.selected_holidays,items:Object.entries(r.all_federal_states).map(([l,c])=>({value:l,title:c}))},null,8,["modelValue","error-messages","items"])]),_:1})]),_:1})]),_:1}),s(d,{cols:"12",md:"6"},{default:t(()=>[s(W,{style:{height:"350px","overflow-y":"auto"},headers:[{title:"Gruppen체bersicht",key:"name"},{title:"",key:"action",align:"end"}],items:r.user_absence_filters,"no-data-text":"Keine Filtergruppen vorhanden."},{"item.name":t(({item:l})=>[o(N(l.name.length>25?l.name.substring(0,25)+"...":l.name),1)]),"item.action":t(({item:l})=>[s(V,null,{default:t(()=>[s(d,{class:"text-end"},{default:t(()=>[s(n,{size:m(A).smAndDown.value?"small":void 0,class:"me-2",variant:"flat",color:"primary",onClick:v(c=>B(l),["stop"])},{default:t(()=>[s(F,null,{default:t(()=>[...e[19]||(e[19]=[o("mdi-pencil",-1)])]),_:1})]),_:1},8,["size","onClick"]),s(n,{size:m(A).smAndDown.value?"small":void 0,variant:"flat",color:"error",loading:m(g).processing&&m(g).filter_id==l.id,onClick:v(c=>{m(g).filter_id=l.id,m(g).delete(r.route("userAbsenceFilter.destroy",{userAbsenceFilter:l.id}),{onSuccess:()=>{a.value.defaults(p).reset()}})},["stop"])},{default:t(()=>[s(F,null,{default:t(()=>[...e[20]||(e[20]=[o("mdi-delete",-1)])]),_:1})]),_:1},8,["size","loading","onClick"])]),_:2},1024)]),_:2},1024)]),_:1},8,["items"])]),_:1}),s(d,{cols:"12",class:"text-end"},{default:t(()=>[s(n,{class:"me-2",color:"primary",variant:"flat",onClick:e[12]||(e[12]=v(l=>a.value.defaults(p).reset(),["stop"]))},{default:t(()=>[...e[21]||(e[21]=[o(" Zur체cksetzen ",-1)])]),_:1}),s(n,{disabled:!a.value.isDirty,color:"primary",type:"submit",loading:a.value.processing},{default:t(()=>[o(N(typeof a.value.set=="string"||a.value.set==null?"Anlegen":"Bearbeiten"),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:2},1032,["modelValue"])]),_:2},1024)]),_:2},1024)]),_:1}))}});export{X as _};

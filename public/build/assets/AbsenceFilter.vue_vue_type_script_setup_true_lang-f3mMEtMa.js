import{d as E,B as S,u as j,C,w as A,r as q,a as w,o as x,b as t,f as s,V as G,x as I,g as K,e as L,i as m,E as O,G as z,H as P,I as D,J as U,K as g,L as i,M as p,N as T,h as R,l as o,m as v,s as n,O as W,y as Z,p as y,t as M,P as H,Q as J}from"./app-BEL-OU-Z.js";const Q={class:"d-flex justify-end"},Y=E({__name:"AbsenceFilter",props:S({user_absence_filters:{},users:{},absence_types:{}},{filterForm:{required:!0},filterFormModifiers:{},singleFilterForm:{required:!0},singleFilterFormModifiers:{}}),emits:["update:filterForm","update:singleFilterForm"],setup(c){const V=c,f={set:null,selected_users:[],selected_absence_types:[],selected_statuses:["created","accepted"]},F=j(),a=C(c,"filterForm"),u=C(c,"singleFilterForm"),b=useForm({filter_id:null});A(()=>a.value.set,k);function k(r){if(r==null)return;let e;if(typeof r=="object"&&a.value.isDirty?e=V.user_absence_filters.find(l=>l.id==r.value):typeof r=="string"&&(e=V.user_absence_filters.find(l=>l.name==r)),!e)return;const d={set:typeof r=="string"?{title:r,value:e.id}:r,selected_users:e.data.user_ids,selected_absence_types:e.data.absence_type_ids,selected_statuses:e.data.statuses};a.value.defaults(d).reset()}A(()=>u.value.set,r=>{if(r==null)return;const e=V.user_absence_filters.find(d=>d.id==r);e&&(u.value.defaults({set:e.id,selected_users:e.data.user_ids,selected_absence_types:e.data.absence_type_ids,selected_statuses:e.data.statuses}),u.value.reset())});function N(){var r;typeof a.value.set!="string"&&((r=a.value.set)!=null&&r.value)?a.value.patch(route("userAbsenceFilter.update",{userAbsenceFilter:a.value.set.value})):a.value.post(route("userAbsenceFilter.store"),{onSuccess:()=>{k(a.value.set)}})}function $(r){const e={value:r.id,title:r.name};a.value.defaults({set:e,selected_users:r.data.user_ids??[],selected_absence_types:r.data.absence_type_ids??[],selected_statuses:r.data.statuses??[]}),a.value.set=e,a.value.reset()}const _=q("singleFilter");return A([()=>u.value.set,()=>a.value.set],([r,e],[d,l])=>{d==null&&r!=null?a.value.defaults(f).reset():l==null&&e!=null&&u.value.defaults(f).reset()}),(r,e)=>(x(),w(J,{"max-width":"1000"},{activator:t(({props:d})=>[s(o,H(d,{variant:"flat",color:"primary"}),{default:t(()=>[s(y,null,{default:t(()=>[...e[13]||(e[13]=[n("mdi-filter",-1)])]),_:1})]),_:1},16)]),default:t(({isActive:d})=>[s(G,{title:"Abwesenheiten filtern"},{append:t(()=>[s(o,{icon:"",variant:"text",onClick:l=>{d.value=!1,c.filterForm.reset()}},{default:t(()=>[s(y,null,{default:t(()=>[...e[14]||(e[14]=[n("mdi-close",-1)])]),_:1})]),_:1},8,["onClick"])]),default:t(()=>[s(I),s(K,null,{default:t(()=>[m(F).smAndDown.value?L("",!0):(x(),w(O,{key:0,modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=l=>_.value=l),color:"primary"},{default:t(()=>[s(z,{text:"Einzelfilter",value:"singleFilter"}),s(z,{text:"Filtergruppen",value:"groupFilter"})]),_:1},8,["modelValue"])),s(P,{modelValue:_.value,"onUpdate:modelValue":e[12]||(e[12]=l=>_.value=l),class:"w-100"},{default:t(()=>[s(D,{value:"singleFilter"},{default:t(()=>[s(U,null,{default:t(()=>[s(g,{class:"mt-2"},{default:t(()=>[s(i,{cols:"12"},{default:t(()=>[s(p,{label:"Filtergruppe ausw채hlen","auto-select-first":"exact",variant:"underlined",items:r.user_absence_filters.map(l=>({value:l.id,title:l.name})),modelValue:u.value.set,"onUpdate:modelValue":e[1]||(e[1]=l=>u.value.set=l),"error-messages":u.value.errors.set,"item-title":"title","item-value":"value",required:"",clearable:""},null,8,["items","modelValue","error-messages"])]),_:1}),s(i,{cols:"12"},{default:t(()=>[s(T,{label:"Nutzer",items:r.users.map(l=>({title:l.first_name+" "+l.last_name,value:l.id})),modelValue:u.value.selected_users,"onUpdate:modelValue":e[2]||(e[2]=l=>u.value.selected_users=l),"error-messages":u.value.errors.selected_users,clearable:"",chips:"",multiple:"",variant:"underlined"},null,8,["items","modelValue","error-messages"])]),_:1}),s(i,{cols:"12"},{default:t(()=>[s(p,{label:"Abwesenheitsgrund",items:r.absence_types.map(l=>({title:l.name,value:l.id})),modelValue:u.value.selected_absence_types,"onUpdate:modelValue":e[3]||(e[3]=l=>u.value.selected_absence_types=l),"error-messages":u.value.errors.selected_absence_types,clearable:"",chips:"",multiple:""},null,8,["items","modelValue","error-messages"])]),_:1}),s(i,{cols:"12"},{default:t(()=>[s(p,{label:"Abwesenheitsstatus",items:[{title:"Erstellt",value:"created"},{title:"Akzeptiert",value:"accepted"},{title:"Abgelehnt",value:"declined"}],modelValue:u.value.selected_statuses,"onUpdate:modelValue":e[4]||(e[4]=l=>u.value.selected_statuses=l),"error-messages":u.value.errors.selected_statuses,clearable:"",chips:"",multiple:""},null,8,["modelValue","error-messages"])]),_:1}),s(i,{cols:"12"},{default:t(()=>[R("div",Q,[s(o,{class:"me-2",color:"primary",variant:"flat",onClick:e[5]||(e[5]=v(l=>u.value.defaults(f).reset(),["stop"]))},{default:t(()=>[...e[15]||(e[15]=[n(" Zur체cksetzen ",-1)])]),_:1}),s(o,{color:"primary",variant:"flat",onClick:v(l=>d.value=!1,["stop"])},{default:t(()=>[...e[16]||(e[16]=[n("Anwenden",-1)])]),_:1},8,["onClick"])])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),s(D,{value:"groupFilter"},{default:t(()=>[s(U,{onSubmit:e[11]||(e[11]=v(l=>N(),["prevent"]))},{default:t(()=>[s(g,{class:"mt-2"},{default:t(()=>[s(i,{cols:"12",md:"6"},{default:t(()=>[s(g,null,{default:t(()=>[s(i,{cols:"12"},{default:t(()=>[s(W,{label:"Gruppename","model-value":typeof a.value.set=="object"&&a.value.set!==null?a.value.set.title:a.value.set??"","onUpdate:modelValue":e[6]||(e[6]=l=>{a.value.set=l}),"error-messages":a.value.errors.set},null,8,["model-value","error-messages"])]),_:1}),s(i,{cols:"12"},{default:t(()=>[s(T,{label:"Nutzer",items:r.users.map(l=>({title:l.first_name+" "+l.last_name,value:l.id})),modelValue:a.value.selected_users,"onUpdate:modelValue":e[7]||(e[7]=l=>a.value.selected_users=l),"error-messages":a.value.errors.selected_users,clearable:"",chips:"",multiple:"",variant:"underlined"},null,8,["items","modelValue","error-messages"])]),_:1}),s(i,{cols:"12"},{default:t(()=>[s(p,{label:"Abwesenheitsgrund",items:r.absence_types.map(l=>({title:l.name,value:l.id})),modelValue:a.value.selected_absence_types,"onUpdate:modelValue":e[8]||(e[8]=l=>a.value.selected_absence_types=l),"error-messages":a.value.errors.selected_absence_types,clearable:"",chips:"",multiple:""},null,8,["items","modelValue","error-messages"])]),_:1}),s(i,{cols:"12"},{default:t(()=>[s(p,{label:"Abwesenheitsstatus",items:[{title:"Erstellt",value:"created"},{title:"Akzeptiert",value:"accepted"},{title:"Abgelehnt",value:"declined"}],modelValue:a.value.selected_statuses,"onUpdate:modelValue":e[9]||(e[9]=l=>a.value.selected_statuses=l),"error-messages":a.value.errors.selected_statuses,clearable:"",chips:"",multiple:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),s(i,{cols:"12",md:"6"},{default:t(()=>[s(Z,{style:{height:"350px","overflow-y":"auto"},headers:[{title:"Gruppen체bersicht",key:"name"},{title:"",key:"action",align:"end"}],items:r.user_absence_filters,"no-data-text":"Keine Filtergruppen vorhanden."},{"item.name":t(({item:l})=>[n(M(l.name.length>25?l.name.substring(0,25)+"...":l.name),1)]),"item.action":t(({item:l})=>[s(g,null,{default:t(()=>[s(i,{class:"text-end"},{default:t(()=>[s(o,{size:m(F).smAndDown.value?"small":void 0,class:"me-2",variant:"flat",color:"primary",onClick:v(B=>$(l),["stop"])},{default:t(()=>[s(y,null,{default:t(()=>[...e[17]||(e[17]=[n("mdi-pencil",-1)])]),_:1})]),_:1},8,["size","onClick"]),s(o,{size:m(F).smAndDown.value?"small":void 0,variant:"flat",color:"error",loading:m(b).processing&&m(b).filter_id==l.id,onClick:v(B=>{m(b).filter_id=l.id,m(b).delete(r.route("userAbsenceFilter.destroy",{userAbsenceFilter:l.id}),{onSuccess:()=>{a.value.defaults(f).reset()}})},["stop"])},{default:t(()=>[s(y,null,{default:t(()=>[...e[18]||(e[18]=[n("mdi-delete",-1)])]),_:1})]),_:1},8,["size","loading","onClick"])]),_:2},1024)]),_:2},1024)]),_:1},8,["items"])]),_:1}),s(i,{cols:"12",class:"text-end"},{default:t(()=>[s(o,{class:"me-2",color:"primary",variant:"flat",onClick:e[10]||(e[10]=v(l=>a.value.defaults(f).reset(),["stop"]))},{default:t(()=>[...e[19]||(e[19]=[n(" Zur체cksetzen ",-1)])]),_:1}),s(o,{disabled:!a.value.isDirty,color:"primary",type:"submit",loading:a.value.processing},{default:t(()=>[n(M(typeof a.value.set=="string"||a.value.set==null?"Anlegen":"Bearbeiten"),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:2},1032,["modelValue"])]),_:2},1024)]),_:2},1024)]),_:1}))}});export{Y as _};

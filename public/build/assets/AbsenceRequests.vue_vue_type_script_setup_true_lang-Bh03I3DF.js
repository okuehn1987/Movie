import{d as U,r as y,k as L,b as f,g as t,a as b,f as c,e as s,a6 as q,h as u,D as n,a0 as R,V as x,y as Y,i as h,L as A,M as r,U as N,j as p,v as d,P as g,m as V,p as F,t as w,q as T,S as Q,F as j,B as J}from"./app-YtTYc6iL.js";const $=U({__name:"AbsenceRequests",props:{absenceRequests:{}},setup(M){var _;const k=M,l=y(((_=k.absenceRequests)==null?void 0:_.find(o=>o.id==Number(route().params.openAbsence)))??null),i=y(!!l.value),B=y(!1),m=y(1);function C(o,a){var v;const e=(v=k.absenceRequests)==null?void 0:v.find(S=>S.id===a.item.id);e&&(l.value=e,i.value=!0)}function D(o){l.value&&J.patch(route("absence.updateStatus",{absence:l.value.id}),{accepted:o},{onSuccess:()=>{i.value=!1,B.value=!0}})}return(o,a)=>(f(),L(j,null,[t(R,{hover:"","items-per-page":"5",page:m.value,"onUpdate:page":a[1]||(a[1]=e=>m.value=e),"no-data-text":"keine Abwesenheitsanträge vorhanden.","onClick:row":C,items:o.absenceRequests.map(e=>({id:e.id,user:e.user.first_name+" "+e.user.last_name,start:u(n).fromSQL(e.start).toFormat("dd.MM.yyyy"),end:u(n).fromSQL(e.end).toFormat("dd.MM.yyyy"),absence_type:e.absence_type.name})),headers:[{title:"Mitarbeiter",key:"user"},{title:"Abwesenheitsgrund",key:"absence_type"},{title:"Von",key:"start"},{title:"Bis",key:"end"}]},{bottom:s(()=>[o.absenceRequests.length>5?(f(),b(q,{key:0,modelValue:m.value,"onUpdate:modelValue":a[0]||(a[0]=e=>m.value=e),length:Math.ceil(o.absenceRequests.length/5)},null,8,["modelValue","length"])):c("",!0)]),_:1},8,["page","items"]),l.value?(f(),b(Q,{key:0,modelValue:i.value,"onUpdate:modelValue":a[6]||(a[6]=e=>i.value=e),"max-width":"1000"},{default:s(()=>[t(x,{title:"Abwesenheit von "+l.value.user.first_name+" "+l.value.user.last_name},{append:s(()=>[t(V,{icon:"",variant:"text",onClick:a[2]||(a[2]=e=>i.value=!1)},{default:s(()=>[t(T,null,{default:s(()=>[...a[7]||(a[7]=[w("mdi-close",-1)])]),_:1})]),_:1})]),default:s(()=>[t(Y),t(h,null,{default:s(()=>[t(A,null,{default:s(()=>[l.value.absence_type.name=="Urlaub"?(f(),b(r,{key:0,cols:"12"},{default:s(()=>[t(N,{type:l.value.user.leaveDaysForYear<l.value.usedDays?"warning":"info",class:"w-100"},{default:s(()=>[t(A,null,{default:s(()=>[t(r,{cols:"12"},{default:s(()=>[p("div",null,"Benötigte Urlaubstage: "+d(l.value.usedDays?Object.values(l.value.usedDays)[0]:0),1)]),_:1}),t(r,{cols:"12"},{default:s(()=>{var e;return[p("div",null," Genehmigte Urlaubstage für das Jahr "+d(u(n).now().year)+" : "+d((e=l.value.user.usedLeaveDaysForYear[u(n).now().year])==null?void 0:e.accepted),1)]}),_:1}),t(r,{cols:"12"},{default:s(()=>{var e;return[p("div",null," Beantragte Urlaubstage für das Jahr "+d(u(n).now().year)+" : "+d((e=l.value.user.usedLeaveDaysForYear[u(n).now().year])==null?void 0:e.created),1)]}),_:1}),t(r,{cols:"12"},{default:s(()=>{var e,v;return[p("div",null," Gesamt genutzte Urlaubstage für das Jahr "+d(u(n).now().year)+" : "+d((((e=l.value.user.usedLeaveDaysForYear[u(n).now().year])==null?void 0:e.accepted)??0)+(((v=l.value.user.usedLeaveDaysForYear[u(n).now().year])==null?void 0:v.created)??0))+" von "+d(l.value.user.leaveDaysForYear),1)]}),_:1})]),_:1})]),_:1},8,["type"])]),_:1})):c("",!0),t(r,{cols:"12"},{default:s(()=>[t(g,{label:"Abwesenheitsgrund",modelValue:l.value.absence_type.name,"onUpdate:modelValue":a[3]||(a[3]=e=>l.value.absence_type.name=e),readonly:""},null,8,["modelValue"])]),_:1}),t(r,{cols:"12",md:"6"},{default:s(()=>[t(g,{label:"Von:","model-value":u(n).fromSQL(l.value.start).toFormat("dd.MM.yyyy"),readonly:""},null,8,["model-value"])]),_:1}),t(r,{cols:"12",md:"6"},{default:s(()=>[t(g,{label:"Bis:","model-value":u(n).fromSQL(l.value.end).toFormat("dd.MM.yyyy"),readonly:""},null,8,["model-value"])]),_:1})]),_:1})]),_:1}),t(r,{cols:"12",class:"d-flex justify-end ga-3"},{default:s(()=>[t(V,{color:"error",onClick:a[4]||(a[4]=F(e=>D(!1),["stop"]))},{default:s(()=>[...a[8]||(a[8]=[w("Ablehnen",-1)])]),_:1}),t(V,{color:"success",onClick:a[5]||(a[5]=F(e=>D(!0),["stop"]))},{default:s(()=>[...a[9]||(a[9]=[w("Akzeptieren",-1)])]),_:1})]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])):c("",!0)],64))}});export{$ as _};

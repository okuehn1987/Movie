import{d as N,as as B,a as l,b as c,aB as C,e as r,g as y,m as d,p as m,f,h as t,a6 as _,l as b,B as u,q as x,t as T,v as U,D as w,z as A}from"./app-BLqB0iZk.js";import{e as D,h as P}from"./utils-BMZt4xN_.js";const H=N({__name:"NotificationTable",props:{notifications:{},triggeredByUsers:{},tab:{}},setup(k){const n=k,{currentPage:a,lastPage:g,data:v}=D(B(n),"notifications",{tab:n.tab},{flow:"flowNotifications",archive:"archiveNotifications",tide:"tideNotifications"}[n.tab]);function p(i,o){u.patch(route("notification.update",{notification:i.id}),{},{onSuccess:o})}function h(){n.tab!="archive"&&u.post(route("notification.readAll"),{tab:n.tab})}return(i,o)=>(c(),l(A,{page:t(a),"onUpdate:page":o[1]||(o[1]=e=>b(a)?a.value=e:null),headers:[{title:"Titel",key:"data.title"},{title:"Am",key:"created_at"},{title:"Von",key:"triggered_by"},{title:"",key:"actions",align:"end",sortable:!1}],items:t(v).map(e=>{var s;return{...e,triggered_by:((s=i.triggeredByUsers.find(V=>V.id==e.data.triggered_by))==null?void 0:s.name)||"System"}}),"no-data-text":"Keine ungelesenen Benachrichtigungen"},C({"item.created_at":r(({item:e})=>[T(U(t(w).fromISO(e.created_at).toFormat("dd.MM.yyyy HH:mm")),1)]),"item.actions":r(({item:e})=>[i.tab!=="archive"?(c(),l(d,{key:0,color:"primary",icon:"mdi-eye",variant:"text",onClick:m(s=>p(e,()=>t(u).get(t(P)(e))),["stop"])},{default:r(()=>[y(x,{icon:"mdi-eye"})]),_:1},8,["onClick"])):f("",!0),i.tab!=="archive"?(c(),l(d,{key:1,color:"primary",icon:"mdi-close",variant:"text",onClick:m(s=>p(e),["stop"])},null,8,["onClick"])):f("",!0)]),bottom:r(()=>[t(g)>1?(c(),l(_,{key:0,modelValue:t(a),"onUpdate:modelValue":o[0]||(o[0]=e=>b(a)?a.value=e:null),length:t(g)},null,8,["modelValue","length"])):f("",!0)]),_:2},[i.tab!="archive"?{name:"header.actions",fn:r(()=>[y(d,{variant:"text",title:"Alle als gelesen markieren",color:"primary",onClick:m(h,["stop"]),icon:"mdi-close-box-multiple"})]),key:"0"}:void 0]),1032,["page","items"]))}});export{H as _};

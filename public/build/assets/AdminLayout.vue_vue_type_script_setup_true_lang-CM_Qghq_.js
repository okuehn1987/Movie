import{d as N,p as k,o as s,a as l,e as g,f as r,a7 as O,b as n,F as w,C as T,k as m,a3 as I,a8 as W,v as H,x,q as v,u,O as V,z as y,a4 as S,a9 as P,h as d,t as f,E as h,J as A,D as F,aa as U,r as z,ab as E,w as J,ac as q,P as K,Q,ad as R,R as _,ae as j,S as L,af as C,ag as G,ah as X,K as D,s as M}from"./app-CbHgsF73.js";import{a as Y}from"./utils-Dbts_GpD.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ee={class:"ms-4 ga-4 d-flex"},ae={key:1,style:{width:"48px"}},te=N({__name:"AppbarActions",setup($){function e(a){h.post(route("notification.update",{notification:a.id}))}function c(a){let t;if(a.type=="App\\Notifications\\WorkLogPatchNotification")t=route("dispute.index",{openPatch:a.data.work_log_patch_id});else if(a.type=="App\\Notifications\\WorkLogNotification")t=route("dispute.index",{openWorkLog:a.data.work_log_id});else if(a.type=="App\\Notifications\\AbsenceNotification")t=route("dispute.index",{openAbsence:a.data.absence_id});else if(a.type=="App\\Notifications\\AbsencePatchNotification")t=route("dispute.index",{openAbsencePatch:a.data.absence_patch_id});else if(a.type=="App\\Notifications\\AbsenceDeleteNotification")t=route("dispute.index",{openAbsenceDelete:a.data.absence_id});else if(a.type=="App\\Notifications\\DisputeStatusNotification"){if(a.data.type=="delete")return;a.data.log_model=="App\\Models\\Absence"?t=route("absence.index",{openAbsence:a.data.log_id}):a.data.log_model=="App\\Models\\AbsencePatch"?t=route("absence.index",{openAbsencePatch:a.data.log_id}):a.data.log_model=="App\\Models\\WorkLogPatch"?t=route("user.workLog.index",{user:A().props.auth.user.id,openWorkLogPatch:a.data.log_id}):a.data.log_model=="App\\Models\\WorkLog"&&(t=route("user.workLog.index",{user:A().props.auth.user.id,workLog:a.data.log_id}))}return t&&h.get(t,{},{onSuccess:()=>e(a)})}const i=Y();function b(a){const t=F.fromISO(a.created_at),o=i.value.diff(t);return o.as("minutes")<1?"Jetzt":o.as("hours")<1?"vor "+Math.floor(o.as("minutes"))+" minuten":t.day!==i.value.day||t.month!==i.value.month||t.year!==i.value.year?t.toFormat("dd.MM - HH:mm")+" Uhr":t.toFormat("HH:mm")+" Uhr"}return(a,t)=>(s(),k(w,null,[a.$page.props.unreadNotifications.length>0?(s(),l(O,{key:0},{activator:n(({props:o})=>[r(v,x({color:"primary"},o,{stacked:""}),{default:n(()=>[r(W,{content:a.$page.props.unreadNotifications.length,color:"error"},{default:n(()=>[r(H,{icon:"mdi-bell"})]),_:1},8,["content"])]),_:2},1040)]),default:n(()=>[r(I,{onClick:m(()=>{},["stop"])},{default:n(()=>[(s(!0),k(w,null,T(a.$page.props.unreadNotifications.toSorted((o,p)=>p.created_at.localeCompare(o.created_at)),(o,p)=>(s(),k(w,{key:o.id},[p!=0?(s(),l(y,{key:0})):g("",!0),r(S,null,{append:n(()=>[d("div",ee,[r(y,{vertical:""}),o.type!="App\\Notifications\\DisputeStatusNotification"||o.type=="App\\Notifications\\DisputeStatusNotification"&&o.data.type!="delete"?(s(),l(v,{key:0,color:"primary",icon:"mdi-eye",variant:"tonal",onClick:m(B=>c(o),["stop"])},null,8,["onClick"])):(s(),k("div",ae)),r(v,{color:"error",icon:"mdi-delete",variant:"tonal",onClick:m(B=>e(o),["stop"])},null,8,["onClick"])])]),default:n(()=>[r(P,null,{default:n(()=>[d("div",null,f(o.data.title),1),d("div",null,[d("sub",null,f(b(o)),1)])]),_:2},1024)]),_:2},1024)],64))),128))]),_:1})]),_:1})):g("",!0),r(u(V),{href:a.route("user.profile",{user:a.$page.props.auth.user.id})},{default:n(()=>[r(v,{stacked:"",color:"black","prepend-icon":"mdi-account",title:"Profil"})]),_:1},8,["href"]),r(u(V),{method:"post",href:a.route("logout"),as:"button"},{default:n(()=>[r(v,{stacked:"",color:"black","prepend-icon":"mdi-logout",title:"Abmelden"})]),_:1},8,["href"])],64))}}),oe=N({__name:"DrawerMenu",setup($){return(e,c)=>(s(),l(I,{nav:"","onClick:select":c[0]||(c[0]=i=>u(h).get(i.id)),items:[{props:{active:e.route().current("dashboard"),prependIcon:"mdi-view-dashboard"},value:e.route("dashboard"),title:"Dashboard"},e.can("absence","viewIndex")&&{props:{active:e.route().current("absence.index"),prependIcon:"mdi-timer-cancel-outline"},value:e.route("absence.index"),title:"Abwesenheiten"},e.can("workLog","viewIndex")&&{props:{active:e.route().current("workLog.index"),prependIcon:"mdi-clock-outline"},value:e.route("workLog.index"),title:"Arbeitszeiten"},e.can("dispute","viewIndex")&&{props:{active:e.route().current("dispute.index"),prependIcon:"mdi-bookmark-outline"},value:e.route("dispute.index"),title:"Anträge"},e.can("organization","viewShow")&&{title:"Organisation",subtitle:"test",value:e.route("organization.show",{organization:e.$page.props.organization.id}),props:{prependIcon:"mdi-domain",active:e.route().current("organization.show")}},e.can("operatingSite","viewIndex")&&{props:{active:e.route().current("operatingSite.index"),prependIcon:"mdi-map-marker"},value:e.route("operatingSite.index"),title:"Betriebsstätten"},e.can("group","viewIndex")&&{props:{active:e.route().current("group.index"),prependIcon:"mdi-dots-circle"},value:e.route("group.index"),title:"Abteilungen"},e.can("user","viewIndex")&&{props:{active:e.route().current("user.index"),prependIcon:"mdi-account-group"},value:e.route("user.index"),title:"Mitarbeitende"},e.can("user","viewIndex")&&{props:{prependIcon:"mdi-tree",active:e.route().current("organization.tree")},value:e.route("organization.tree",{organization:e.$page.props.organization.id}),title:"Organigramm"},...e.can("organization","viewIndex")?[{type:"divider"},{type:"subheader",title:"Super-Admin"},{props:{prependIcon:"mdi-security",active:e.route().current("organization.index")},value:e.route("organization.index"),title:"Organisationen"}]:[]].filter(Boolean)},null,8,["items"]))}}),re=Z(oe,[["__scopeId","data-v-d2eb9acd"]]),ne={class:"d-flex align-center"},se={class:"text-center font-weight-medium"},ie={class:"d-flex align-center mr-auto ga-2"},le={class:"text-h6 pl-0 ml-5 mb-0",style:{"white-space":"nowrap"}},ce=N({__name:"AdminLayout",props:{title:{},backurl:{}},setup($){const e=A(),c=U().smAndDown,i=z(!c.value),b="Herta";E(1e3*60*2,{only:["unreadNotifications"]},{keepAlive:!0});const a=z(!!e.props.organization.logo);return J(()=>e.props.organization.logo,()=>{a.value=!1,q(()=>a.value=!0)}),(t,o)=>(s(),l(K,null,{default:n(()=>[r(u(Q),{title:t.title},null,8,["title"]),r(R,{color:"background",style:{border:"none"},modelValue:i.value,"onUpdate:modelValue":o[2]||(o[2]=p=>i.value=p),image:"/img/loggedin-background.png"},{default:n(()=>[r(I,null,{default:n(()=>[r(S,{onClick:o[1]||(o[1]=m(p=>u(h).get("/"),["stop"]))},{prepend:n(()=>[r(_,{src:"/img/logo-symbol.png",style:{width:"24px"},class:"me-8"})]),append:n(()=>[r(v,{onClick:o[0]||(o[0]=m(p=>i.value=!1,["stop"])),icon:"mdi-close",variant:"text"})]),default:n(()=>[r(P,null,{default:n(()=>[d("div",ne,[d("h1",se,[d("span",null,f(u(b)),1)])])]),_:1})]),_:1})]),_:1}),r(y),r(re)]),_:1},8,["modelValue"]),r(j,{elevation:"0",color:"background"},{default:n(()=>[!i.value||u(c)?(s(),l(C,{key:0,variant:"text",onClick:o[3]||(o[3]=m(p=>i.value=!i.value,["stop"]))})):g("",!0),t.backurl?(s(),l(C,{key:1,variant:"text",icon:"mdi-arrow-left",onClick:o[4]||(o[4]=m(p=>u(h).visit(t.backurl,{preserveState:!0}),["stop"]))})):g("",!0),d("div",ie,[d("span",le,f(t.title),1),a.value?(s(),l(_,{key:0,src:t.route("organization.getLogo",{organization:t.$page.props.organization.id,key:t.$page.props.organization.logo}),"max-height":"48px","max-width":"48px",width:"100%",height:"100%",class:"rounded"},null,8,["src"])):g("",!0)]),L(t.$slots,"appbarActions"),r(te)]),_:3}),r(G,null,{default:n(()=>[r(X,{class:"pt-0",fluid:""},{default:n(()=>[t.$page.props.flash.error?(s(),l(D,{type:"error",closable:"",class:"mb-6",key:Math.random()},{default:n(()=>[M(f(t.$page.props.flash.error),1)]),_:1})):g("",!0),t.$page.props.flash.success?(s(),l(D,{type:"success",closable:"",class:"mb-6",key:Math.random()},{default:n(()=>[M(f(t.$page.props.flash.success),1)]),_:1})):g("",!0),L(t.$slots,"default")]),_:3})]),_:3})]),_:3}))}});export{ce as _};

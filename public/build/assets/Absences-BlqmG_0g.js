import{A as M}from"./AdminLayout-Cs33-4Ip.js";import{d as A,r as v,a as _,o as m,b as t,f as s,V as C,g as l,h as Q,K as S,e as k,L as y,S as B,s as p,aF as L,j as b,F as h,z as D,aG as N,aH as w,t as o,aI as F,D as r,i as d,y as E,aB as U,az as G}from"./app-D7dl_JAA.js";import{_ as T}from"./UserShowNavBar.vue_vue_type_script_setup_true_lang-DY7H7Tmk.js";import{u as x}from"./utils-DGeuCjju.js";import"./ChatDetails-BHssG7eQ.js";import"./ChatMessage-CE-1nMPs.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"text-h6"},P={class:"font-weight-bold"},Y={colspan:"4"},J={class:"font-weight-bold"},H={colspan:"4"},K={class:"font-weight-bold"},j={colspan:"4"},ee=A({__name:"Absences",props:{user:{},usedLeaveDaysForYear:{},absenceTypes:{}},setup(I){const V=v([]),g=v([]);return(n,f)=>(m(),_(M,{title:n.user.first_name+" "+n.user.last_name},{default:t(()=>[s(T,{user:n.user,tab:"absences"},null,8,["user"]),s(C,{"max-height":l(x)(48).value,class:"overflow-auto"},{default:t(()=>[s(Q,null,{default:t(()=>[s(S,null,{default:t(()=>[n.user.absences.length===0?(m(),_(y,{key:0},{default:t(()=>[s(B,{color:"info"},{default:t(()=>[...f[2]||(f[2]=[p("Keine Abwesenheiten vorhanden.",-1)])]),_:1})]),_:1})):k("",!0),s(y,null,{default:t(()=>[s(L,{elevation:"1",multiple:"",modelValue:g.value,"onUpdate:modelValue":f[1]||(f[1]=c=>g.value=c)},{default:t(()=>[(m(!0),b(h,null,D(n.usedLeaveDaysForYear,(c,a)=>(m(),_(N,{key:a,value:a},{default:t(()=>[s(w,null,{default:t(()=>[p(o(a),1)]),_:2},1024),s(F,null,{default:t(()=>[s(L,{elevation:"1",multiple:"",modelValue:V.value,"onUpdate:modelValue":f[0]||(f[0]=u=>V.value=u)},{default:t(()=>[(m(!0),b(h,null,D(n.absenceTypes,u=>(m(),b(h,{key:a+"/"+u.id},[n.user.absences.filter(e=>e.absence_type_id==u.id&&l(r).fromSQL(e.start).year<=Number(a)&&l(r).fromSQL(e.end).year>=Number(a)).reduce((e,i)=>e+(i.usedDays[a]??0),0)>0?(m(),_(N,{key:0,value:a+"/"+u.id},{default:t(()=>[s(w,null,{default:t(()=>[s(S,null,{default:t(()=>[s(y,{cols:"12",md:"11"},{default:t(()=>[d("h2",z,o(u.name),1)]),_:2},1024),s(y,{cols:"12",md:"1",style:{"place-self":"center"}},{default:t(()=>[p(o(n.user.absences.filter(e=>e.absence_type_id==u.id&&l(r).fromSQL(e.start).year<=Number(a)&&l(r).fromSQL(e.end).year>=Number(a)).reduce((e,i)=>e+(i.usedDays[a]??0),0))+" Tage ",1)]),_:2},1024)]),_:2},1024)]),_:2},1024),s(F,null,{default:t(()=>[s(E,{id:"userAbsenceTable",items:n.user.absences.filter(e=>e.absence_type_id==u.id&&l(r).fromSQL(e.start).year<=Number(a)&&l(r).fromSQL(e.end).year>=Number(a)).toSorted((e,i)=>i.start.localeCompare(e.start)).map(e=>{var i;return{...e,start:l(r).fromSQL(e.start).toFormat("dd.MM.yyyy"),end:l(r).fromSQL(e.end).toFormat("dd.MM.yyyy"),absence_type:(i=e.absence_type)==null?void 0:i.name,usedDays:e.usedDays[a]}}),headers:[{title:"Start",key:"start"},{title:"Ende",key:"end"},{title:"Status",key:"status"},{title:"Art",key:"absence_type"},{title:"Genutzte Tage",key:"usedDays"}]},U({"item.status":t(({item:e})=>[s(G,{color:{accepted:"success",created:"warning",declined:"error"}[e.status]},{default:t(()=>[p(o({accepted:"Genehmigt",created:"Offen",declined:"Abgelehnt"}[e.status]),1)]),_:2},1032,["color"])]),"item.start":t(({item:e})=>[p(o(l(r).fromFormat(e.start,"dd.MM.yyyy").year!=Number(a)?"01.01."+a:e.start),1)]),"item.end":t(({item:e})=>[p(o(l(r).fromFormat(e.end,"dd.MM.yyyy").year!=Number(a)?"31.12."+a:e.end),1)]),_:2},[u.name=="Urlaub"?{name:"body.append",fn:t(()=>[d("tr",P,[d("td",Y," Genehmigte Urlaubstage für das Jahr "+o(l(r).now().year)+": ",1),d("td",null,o(c.accepted),1)]),d("tr",J,[d("td",H," Beantragte Urlaubstage für das Jahr "+o(l(r).now().year)+": ",1),d("td",null,o(c.created),1)]),d("tr",K,[d("td",j," Gesamt genutzte Urlaubstage für das Jahr "+o(l(r).now().year)+": ",1),d("td",null,o(c.accepted+c.created+" von "+n.user.leaveDaysForYear),1)])]),key:"0"}:void 0]),1032,["items"])]),_:2},1024)]),_:2},1032,["value"])):k("",!0)],64))),128))]),_:2},1032,["modelValue"])]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["max-height"])]),_:1},8,["title"]))}});export{ee as default};

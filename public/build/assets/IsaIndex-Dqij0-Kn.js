import{d as R,at as b,as as U,r as $,a as d,b as u,e as s,f as A,g as e,V as k,aC as F,t as n,i as C,K as w,p as _,h as i,L as m,ap as c,M as r,x as I,P as M,m as f,q as h,j as q,N as D,z as E,D as L,aB as H,s as j,B as O}from"./app-BLqB0iZk.js";import{A as G}from"./AdminLayout-DkLXg4ql.js";import{_ as J}from"./PaymentTable.vue_vue_type_script_setup_true_lang-1jyv9eFa.js";import"./ChatDetails-E-HJ94NU.js";import"./ChatMessage-C12vuucj.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./utils-BMZt4xN_.js";const et=R({__name:"IsaIndex",props:{chatAssistant:{},files:{},stats:{}},setup(S){const p=S,o=b({chatFile_ids:p.chatAssistant.chat_files.map(t=>t.id),monthly_cost_limit:p.chatAssistant.monthly_cost_limit}),{files:z}=U(p),g=b({files:[]}),B=p.chatAssistant.id,y=$(null);function N(){var t;(t=y.value)==null||t.click()}function T(t){g.files=t,g.post(route("file.store"),{onSuccess:()=>{g.reset()},onFinish:()=>{y.value&&(y.value.value="")}})}function K(t){O.delete(route("file.destroy",t.id),{})}function v(t,a){const l=t/a*100;return l>=90?"error":l>=70?"warning":"success"}return(t,a)=>(u(),d(G,{title:"Einstellungen für ISA",tooltip:"TooltipChatAssistantIndex"},{default:s(()=>[t.can("chatAssistant","showPaymentInfo")?(u(),d(k,{key:0,class:"mb-4"},{default:s(()=>[e(F,{class:"my-4"},{default:s(()=>[...a[7]||(a[7]=[n("Kostenverwaltung",-1)])]),_:1}),e(C,null,{default:s(()=>[t.can("chatAssistant","update")?(u(),d(w,{key:0,onSubmit:a[1]||(a[1]=_(l=>i(o).patch(t.route("isa.update",{isa:t.chatAssistant.id})),["prevent"]))},{default:s(()=>[e(m,null,{default:s(()=>[e(c,{class:"mt-4"},{default:s(()=>[...a[8]||(a[8]=[n("Aktuelle Verbrauchsanzeige",-1)])]),_:1}),e(r,{class:"pt-2 mb-4",cols:"12"},{default:s(()=>[e(I,{title:" "+Math.floor(t.chatAssistant.current_monthly_cost/t.chatAssistant.monthly_cost_limit*100)+"% des monatlichen Kostenlimits sind erreicht",rounded:"",max:t.chatAssistant.monthly_cost_limit,"model-value":t.chatAssistant.current_monthly_cost,color:v(t.chatAssistant.current_monthly_cost,t.chatAssistant.monthly_cost_limit),height:"15"},null,8,["title","max","model-value","color"])]),_:1}),e(r,{cols:"11"},{default:s(()=>[e(M,{modelValue:i(o).monthly_cost_limit,"onUpdate:modelValue":a[0]||(a[0]=l=>i(o).monthly_cost_limit=l),label:"Monatliches Kostenlimit in €",required:"",errorMessages:i(o).errors.monthly_cost_limit,variant:"outlined",density:"compact"},null,8,["modelValue","errorMessages"])]),_:1}),e(r,{cols:"1",class:"text-end"},{default:s(()=>[e(f,{color:"primary",type:"submit",disabled:i(o).processing,loading:i(o).processing},{default:s(()=>[e(h,{size:"large"},{default:s(()=>[...a[9]||(a[9]=[n("mdi-content-save",-1)])]),_:1})]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1})):(u(),d(m,{key:1},{default:s(()=>[e(c,{class:"mt-4"},{default:s(()=>[...a[10]||(a[10]=[n("Aktuelle Verbrauchsanzeige",-1)])]),_:1}),e(r,{class:"pt-2 mb-4",cols:"12"},{default:s(()=>[e(I,{title:" "+Math.floor(t.chatAssistant.current_monthly_cost/t.chatAssistant.monthly_cost_limit*100)+"% des monatlichen Kostenlimits sind erreicht",rounded:"",max:t.chatAssistant.monthly_cost_limit,"model-value":t.chatAssistant.current_monthly_cost,color:v(t.chatAssistant.current_monthly_cost,t.chatAssistant.monthly_cost_limit),height:"15"},null,8,["title","max","model-value","color"])]),_:1}),e(r,{cols:"12"},{default:s(()=>[e(M,{modelValue:i(o).monthly_cost_limit,"onUpdate:modelValue":a[2]||(a[2]=l=>i(o).monthly_cost_limit=l),label:"Monatliches Kostenlimit in €",required:"",errorMessages:i(o).errors.monthly_cost_limit,"hide-details":"",variant:"outlined",density:"compact"},null,8,["modelValue","errorMessages"])]),_:1})]),_:1})),e(m,null,{default:s(()=>[e(c,{class:"mt-8"},{default:s(()=>[...a[11]||(a[11]=[n("Verbrauchsübersicht",-1)])]),_:1}),e(r,{cols:"12"},{default:s(()=>[e(J,{stats:t.stats,chatAssistantId:i(B)},null,8,["stats","chatAssistantId"])]),_:1})]),_:1})]),_:1})]),_:1})):A("",!0),e(k,{class:"mb-4"},{default:s(()=>[e(F,{class:"my-4"},{default:s(()=>[...a[12]||(a[12]=[n("Dateiverwaltung",-1)])]),_:1}),e(c,{class:"mt-4"},{default:s(()=>[...a[13]||(a[13]=[n("Verwendete Dateien",-1)])]),_:1}),e(C,{class:"pt-0"},{default:s(()=>[t.can("chatAssistant","update")?(u(),d(w,{key:0,onSubmit:a[4]||(a[4]=_(l=>i(o).patch(t.route("isa.update",{isa:t.chatAssistant.id})),["prevent"]))},{default:s(()=>[e(m,null,{default:s(()=>[e(r,{cols:"11"},{default:s(()=>[e(D,{color:"primary",items:t.files.map(l=>({title:l.name,value:l.id})),modelValue:i(o).chatFile_ids,"onUpdate:modelValue":a[3]||(a[3]=l=>i(o).chatFile_ids=l),multiple:"",chips:"","no-data-text":"Es wurden keine Dateien hochgeladen",errorMessages:i(o).errors.chatFile_ids,"hide-details":"",density:"comfortable"},null,8,["items","modelValue","errorMessages"])]),_:1}),e(r,{cols:"1",class:"text-end"},{default:s(()=>[e(f,{color:"primary",type:"submit",disabled:i(o).processing,loading:i(o).processing},{default:s(()=>[e(h,{size:"large"},{default:s(()=>[...a[14]||(a[14]=[n("mdi-content-save",-1)])]),_:1})]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1})):(u(),d(m,{key:1},{default:s(()=>[e(r,{cols:"12"},{default:s(()=>[e(D,{color:"primary",items:t.files.map(l=>({title:l.name,value:l.id})),modelValue:i(o).chatFile_ids,"onUpdate:modelValue":a[5]||(a[5]=l=>i(o).chatFile_ids=l),multiple:"",chips:"","hide-details":"",density:"comfortable"},null,8,["items","modelValue"])]),_:1})]),_:1}))]),_:1}),e(c,{class:"mt-6"},{default:s(()=>[...a[15]||(a[15]=[n("Dateiübersicht",-1)])]),_:1}),q("input",{hidden:"",ref_key:"fileInputRef",ref:y,type:"file",accept:"application/pdf",multiple:"",onChange:a[6]||(a[6]=l=>T(l.target.files))},null,544),e(E,{"fixed-header":"","no-data-text":"Es wurden noch keine Dateien Hochgeladen",class:"mx-auto",headers:[{title:"Dateiname",value:"name"},{title:"Hinzugefügt",value:"created_at"},{title:"Status",value:"is_used_text"},{title:"",value:"actions",align:"end"}],items:i(z).map(l=>{const V=!!t.chatAssistant.chat_files.find(P=>P.id==l.id);return{...l,created_at:i(L).fromISO(l.created_at).toFormat("dd.MM.yyyy hh:mm"),is_used:V,is_used_text:V?"In Benutzung":"Nicht verwendet"}})},H({"item.actions":s(({item:l})=>[t.can("chatAssistant","showChatFiles")?(u(),d(f,{key:0,href:t.route("file.show",{file:l.id.toString()})},{default:s(()=>[e(h,{icon:"mdi-eye",color:"primary"})]),_:1},8,["href"])):A("",!0),t.can("chatAssistant","editChatFiles")?(u(),d(f,{key:1,disabled:l.is_used,onClick:_(V=>K(l),["stop"]),class:"ms-2",color:"error",style:j([{"pointer-events":"auto"},{cursor:l.is_used?"default":"pointer"}]),title:l.is_used?"Verwendete Dateien können nicht gelöscht werden":"Datei entfernen"},{default:s(()=>[e(h,{icon:"mdi-delete"})]),_:1},8,["disabled","onClick","style","title"])):A("",!0)]),_:2},[t.can("chatAssistant","editChatFiles")?{name:"header.actions",fn:s(()=>[e(f,{title:"Neue Datei hochladen",color:"primary",onClick:_(N,["stop"])},{default:s(()=>[e(h,{icon:"mdi-plus"})]),_:1})]),key:"0"}:void 0]),1032,["items"])]),_:1})]),_:1}))}});export{et as default};
